<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VTOX é«˜å¹¶å‘è´Ÿè½½å‡è¡¡ä¼˜åŒ–æ–¹æ¡ˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', 'SimHei', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            color: #2c3e50;
            font-size: 2.8em;
            margin-bottom: 15px;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header .subtitle {
            color: #7f8c8d;
            font-size: 1.3em;
            margin-bottom: 25px;
        }

        .current-status {
            background: linear-gradient(135deg, #ff7675, #fd79a8);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: center;
        }

        .section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 35px;
            margin-bottom: 30px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        }

        .section h2 {
            color: #2c3e50;
            font-size: 2em;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 4px solid #3498db;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .section h3 {
            color: #34495e;
            font-size: 1.6em;
            margin: 30px 0 20px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .emoji {
            font-size: 1.3em;
        }

        .architecture-diagram {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
            margin: 25px 0;
            text-align: center;
        }

        .arch-flow {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .arch-box {
            background: white;
            border: 3px solid #3498db;
            border-radius: 15px;
            padding: 20px;
            min-width: 150px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .arch-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }

        .arch-box.simulator { border-color: #e74c3c; }
        .arch-box.loadbalancer { border-color: #f39c12; }
        .arch-box.backend { border-color: #27ae60; }
        .arch-box.queue { border-color: #9b59b6; }

        .arrow {
            font-size: 2em;
            color: #3498db;
            font-weight: bold;
        }

        .code-example {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 25px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            margin: 20px 0;
            overflow-x: auto;
        }

        .implementation-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }

        .impl-card {
            background: white;
            border: 2px solid #ecf0f1;
            border-radius: 15px;
            padding: 25px;
            transition: all 0.3s ease;
        }

        .impl-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            border-color: #3498db;
        }

        .impl-card h4 {
            color: #2c3e50;
            font-size: 1.4em;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tech-stack {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            padding: 35px;
            border-radius: 15px;
            margin: 25px 0;
        }

        .stack-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .stack-item {
            background: rgba(255, 255, 255, 0.2);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .stack-item h4 {
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .performance-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            margin: 25px 0;
        }

        .performance-table th,
        .performance-table td {
            padding: 15px;
            text-align: center;
            border-bottom: 1px solid #ecf0f1;
        }

        .performance-table th {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            font-weight: 600;
        }

        .performance-table tr:hover {
            background: #f8f9fa;
        }

        .metric-good { color: #27ae60; font-weight: 600; }
        .metric-warning { color: #f39c12; font-weight: 600; }
        .metric-danger { color: #e74c3c; font-weight: 600; }

        .timeline {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 35px;
            border-radius: 15px;
            margin: 25px 0;
        }

        .timeline-step {
            display: flex;
            align-items: flex-start;
            margin: 25px 0;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }

        .step-number {
            background: rgba(255, 255, 255, 0.9);
            color: #667eea;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            margin-right: 20px;
            flex-shrink: 0;
        }

        .step-content h4 {
            margin-bottom: 10px;
            font-size: 1.3em;
        }

        .command-box {
            background: #34495e;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }

        .highlight-box {
            background: linear-gradient(135deg, #00b894, #00a085);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
            text-align: center;
        }

        .highlight-number {
            font-size: 2.5em;
            font-weight: 700;
            margin: 10px 0;
        }

        .monitor-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .monitor-card {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
        }

        .monitor-card h4 {
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .monitor-value {
            font-size: 1.8em;
            font-weight: 700;
            color: #3498db;
            margin: 10px 0;
        }

        @media (max-width: 768px) {
            .container { padding: 10px; }
            .header h1 { font-size: 2.2em; }
            .section { padding: 25px; }
            .implementation-grid { grid-template-columns: 1fr; }
            .arch-flow { flex-direction: column; }
            .stack-grid { grid-template-columns: 1fr; }
            .monitor-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- æŠ¥å‘Šå¤´éƒ¨ -->
        <div class="header">
            <h1>ğŸš€ VTOX é«˜å¹¶å‘è´Ÿè½½å‡è¡¡ä¼˜åŒ–æ–¹æ¡ˆ</h1>
            <div class="subtitle">10ç«¯å£æ¨¡æ‹Ÿ1000è½¦ Â· é«˜é¢‘æ•°æ® Â· è´Ÿè½½å‡è¡¡ Â· å®æ—¶å¤„ç†</div>
            
            <div class="current-status">
                <strong>ğŸ¯ ç›®æ ‡ï¼š</strong>æœ¬åœ°10ç«¯å£æ¨¡æ‹Ÿ1000è¾†è½¦é«˜é¢‘å‘é€æ•°æ®ï¼Œå®ç°è´Ÿè½½å‡è¡¡å’Œé«˜å¯ç”¨æ€§
            </div>
        </div>

        <!-- æ¶æ„è®¾è®¡ -->
        <div class="section">
            <h2><span class="emoji">ğŸ—ï¸</span> é«˜å¹¶å‘æ¶æ„è®¾è®¡</h2>
            
            <div class="architecture-diagram">
                <h3>ğŸ“Š æ•´ä½“æ¶æ„æµç¨‹</h3>
                <div class="arch-flow">
                    <div class="arch-box simulator">
                        <h4>ğŸš— è½¦è¾†æ¨¡æ‹Ÿå™¨</h4>
                        <p>10ä¸ªç«¯å£</p>
                        <p>100è½¦/ç«¯å£</p>
                    </div>
                    <div class="arrow">â†’</div>
                    <div class="arch-box loadbalancer">
                        <h4>âš–ï¸ è´Ÿè½½å‡è¡¡</h4>
                        <p>Nginx/HAProxy</p>
                        <p>è½®è¯¢/æƒé‡</p>
                    </div>
                    <div class="arrow">â†’</div>
                    <div class="arch-box backend">
                        <h4>ğŸ–¥ï¸ åç«¯é›†ç¾¤</h4>
                        <p>3ä¸ªå®ä¾‹</p>
                        <p>FastAPI</p>
                    </div>
                    <div class="arrow">â†’</div>
                    <div class="arch-box queue">
                        <h4>ğŸ“¬ æ¶ˆæ¯é˜Ÿåˆ—</h4>
                        <p>Redis/AutoMQ</p>
                        <p>å¼‚æ­¥å¤„ç†</p>
                    </div>
                </div>
            </div>

            <div class="highlight-box">
                <h4>ğŸ¯ æ€§èƒ½ç›®æ ‡</h4>
                <div class="highlight-number">10ä¸‡</div>
                <p>æ¶ˆæ¯/ç§’å¤„ç†èƒ½åŠ› (1000è½¦ Ã— 100msg/s)</p>
            </div>
        </div>

        <!-- æŠ€æœ¯æ ˆé€‰æ‹© -->
        <div class="section">
            <h2><span class="emoji">ğŸ› ï¸</span> æ¨èæŠ€æœ¯æ ˆ</h2>
            
            <div class="tech-stack">
                <h3 style="color: white; text-align: center; margin-bottom: 25px;">ğŸ”§ å®Œæ•´æŠ€æœ¯æ ˆ</h3>
                
                <div class="stack-grid">
                    <div class="stack-item">
                        <h4>ğŸš— è½¦è¾†æ¨¡æ‹Ÿ</h4>
                        <p>Python Asyncio</p>
                        <p>WebSocket/HTTP</p>
                        <p>å¤šè¿›ç¨‹å¹¶å‘</p>
                    </div>
                    <div class="stack-item">
                        <h4>âš–ï¸ è´Ÿè½½å‡è¡¡</h4>
                        <p>Nginx</p>
                        <p>HAProxy</p>
                        <p>Docker Swarm</p>
                    </div>
                    <div class="stack-item">
                        <h4>ğŸ–¥ï¸ åç«¯æœåŠ¡</h4>
                        <p>FastAPI</p>
                        <p>Uvicorn</p>
                        <p>å¼‚æ­¥å¤„ç†</p>
                    </div>
                    <div class="stack-item">
                        <h4>ğŸ“¬ æ¶ˆæ¯é˜Ÿåˆ—</h4>
                        <p>Redis Streams</p>
                        <p>AutoMQ (æ¨è)</p>
                        <p>RocketMQ</p>
                    </div>
                    <div class="stack-item">
                        <h4>ğŸ’¾ æ•°æ®å­˜å‚¨</h4>
                        <p>PostgreSQL</p>
                        <p>Redis Cache</p>
                        <p>InfluxDB (æ—¶åº)</p>
                    </div>
                    <div class="stack-item">
                        <h4>ğŸ“Š ç›‘æ§å‘Šè­¦</h4>
                        <p>Prometheus</p>
                        <p>Grafana</p>
                        <p>ELK Stack</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- å®æ–½æ–¹æ¡ˆ -->
        <div class="section">
            <h2><span class="emoji">âš¡</span> æ ¸å¿ƒå®æ–½æ–¹æ¡ˆ</h2>
            
            <div class="implementation-grid">
                <div class="impl-card">
                    <h4><span class="emoji">ğŸš—</span> æ–¹æ¡ˆ1: è½¦è¾†æ¨¡æ‹Ÿå™¨</h4>
                    <div class="code-example">
# é«˜å¹¶å‘è½¦è¾†æ•°æ®æ¨¡æ‹Ÿå™¨
import asyncio
import aiohttp
import json
from concurrent.futures import ProcessPoolExecutor

class VehicleSimulator:
    def __init__(self, port_start=8001, cars_per_port=100):
        self.port_start = port_start
        self.cars_per_port = cars_per_port
        self.total_ports = 10
        
    async def simulate_vehicle(self, vehicle_id, target_url):
        """æ¨¡æ‹Ÿå•è½¦æ•°æ®å‘é€"""
        async with aiohttp.ClientSession() as session:
            while True:
                data = {
                    "vehicle_id": vehicle_id,
                    "timestamp": time.time(),
                    "speed": random.uniform(0, 120),
                    "engine_temp": random.uniform(80, 95),
                    "battery_level": random.uniform(20, 100),
                    "location": {
                        "lat": random.uniform(39.9, 40.1),
                        "lng": random.uniform(116.3, 116.5)
                    },
                    "fault_data": {
                        "Ia": random.uniform(-10, 10),
                        "Ib": random.uniform(-10, 10), 
                        "Ic": random.uniform(-10, 10)
                    }
                }
                
                try:
                    await session.post(target_url, json=data)
                    await asyncio.sleep(0.01)  # 100Hzé¢‘ç‡
                except Exception as e:
                    print(f"Vehicle {vehicle_id} error: {e}")
                    await asyncio.sleep(1)

# å¯åŠ¨æ¨¡æ‹Ÿå™¨
python vehicle_simulator.py --cars=1000 --frequency=100
                    </div>
                    <p><strong>ç‰¹ç‚¹ï¼š</strong>æ”¯æŒ1000è½¦Ã—100Hzé«˜é¢‘æ•°æ®å‘é€</p>
                </div>

                <div class="impl-card">
                    <h4><span class="emoji">âš–ï¸</span> æ–¹æ¡ˆ2: Nginxè´Ÿè½½å‡è¡¡</h4>
                    <div class="code-example">
# nginx.conf
upstream vtox_backend {
    least_conn;  # æœ€å°‘è¿æ¥ç®—æ³•
    server backend1:8000 weight=3;
    server backend2:8000 weight=3; 
    server backend3:8000 weight=2;
    keepalive 32;
}

server {
    listen 80;
    
    location /api/ {
        proxy_pass http://vtox_backend;
        proxy_http_version 1.1;
        proxy_set_header Connection "";
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        
        # é™æµé…ç½®
        limit_req zone=api burst=100 nodelay;
    }
    
    location /ws/ {
        proxy_pass http://vtox_backend;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
    }
}

# å¯åŠ¨å‘½ä»¤
docker-compose up -d nginx
                    </div>
                    <p><strong>ç‰¹ç‚¹ï¼š</strong>æ”¯æŒ10ä¸‡å¹¶å‘è¿æ¥ï¼Œæ™ºèƒ½è´Ÿè½½åˆ†å‘</p>
                </div>

                <div class="impl-card">
                    <h4><span class="emoji">ğŸ–¥ï¸</span> æ–¹æ¡ˆ3: åç«¯ä¼˜åŒ–</h4>
                    <div class="code-example">
# optimized_main.py
from fastapi import FastAPI
import asyncio
import uvloop  # æ€§èƒ½ä¼˜åŒ–
from concurrent.futures import ThreadPoolExecutor

# ä½¿ç”¨æ€§èƒ½æ›´å¥½çš„äº‹ä»¶å¾ªç¯
asyncio.set_event_loop_policy(uvloop.EventLoopPolicy())

app = FastAPI()

# çº¿ç¨‹æ± å¤„ç†CPUå¯†é›†å‹ä»»åŠ¡
executor = ThreadPoolExecutor(max_workers=8)

# è¿æ¥æ± ä¼˜åŒ–
from sqlalchemy.pool import QueuePool
engine = create_engine(
    DATABASE_URL,
    poolclass=QueuePool,
    pool_size=20,
    max_overflow=30,
    pool_pre_ping=True
)

@app.post("/api/fault_data")
async def receive_fault_data(data: FaultData):
    """å¼‚æ­¥å¤„ç†æ•…éšœæ•°æ®"""
    # å¿«é€Ÿå“åº”
    asyncio.create_task(process_fault_data(data))
    return {"status": "received"}

async def process_fault_data(data):
    """åå°å¼‚æ­¥å¤„ç†"""
    # å‘é€åˆ°æ¶ˆæ¯é˜Ÿåˆ—
    await queue.send_message('fault_data', data.dict())
    
# å¯åŠ¨å‘½ä»¤  
uvicorn main:app --workers 4 --host 0.0.0.0 --port 8000
                    </div>
                    <p><strong>ç‰¹ç‚¹ï¼š</strong>å¼‚æ­¥å¤„ç†ï¼Œè¿æ¥æ± ä¼˜åŒ–ï¼Œé«˜ååé‡</p>
                </div>

                <div class="impl-card">
                    <h4><span class="emoji">ğŸ“¬</span> æ–¹æ¡ˆ4: æ¶ˆæ¯é˜Ÿåˆ—å‡çº§</h4>
                    <div class="code-example">
# redis_cluster.py - Redisé›†ç¾¤æ–¹æ¡ˆ
import redis.asyncio as redis
from redis.asyncio import RedisCluster

# Redisé›†ç¾¤é…ç½®
startup_nodes = [
    {"host": "redis-1", "port": "7000"},
    {"host": "redis-2", "port": "7000"}, 
    {"host": "redis-3", "port": "7000"}
]

redis_cluster = RedisCluster(
    startup_nodes=startup_nodes,
    decode_responses=True,
    skip_full_coverage_check=True
)

class HighPerformanceQueue:
    async def send_message(self, topic, data):
        """é«˜æ€§èƒ½æ¶ˆæ¯å‘é€"""
        await redis_cluster.xadd(
            topic, 
            data, 
            maxlen=100000  # é™åˆ¶é˜Ÿåˆ—é•¿åº¦
        )
    
    async def batch_send(self, topic, messages):
        """æ‰¹é‡å‘é€ä¼˜åŒ–"""
        pipeline = redis_cluster.pipeline()
        for msg in messages:
            pipeline.xadd(topic, msg)
        await pipeline.execute()

# AutoMQæ–¹æ¡ˆ (æ¨è)
from kafka import KafkaProducer
producer = KafkaProducer(
    bootstrap_servers=['automq-cluster:9092'],
    batch_size=16384,  # æ‰¹é‡å‘é€
    linger_ms=10,      # å»¶è¿Ÿå‘é€
    compression_type='lz4'  # å‹ç¼©
)
                    </div>
                    <p><strong>ç‰¹ç‚¹ï¼š</strong>é›†ç¾¤éƒ¨ç½²ï¼Œæ‰¹é‡å¤„ç†ï¼Œé«˜å¯ç”¨</p>
                </div>
            </div>
        </div>

        <!-- æ€§èƒ½å¯¹æ¯” -->
        <div class="section">
            <h2><span class="emoji">ğŸ“Š</span> æ€§èƒ½å¯¹æ¯”åˆ†æ</h2>
            
            <table class="performance-table">
                <thead>
                    <tr>
                        <th>æ–¹æ¡ˆ</th>
                        <th>å¹¶å‘è¿æ¥</th>
                        <th>æ¶ˆæ¯ååé‡</th>
                        <th>å“åº”å»¶è¿Ÿ</th>
                        <th>CPUä½¿ç”¨ç‡</th>
                        <th>å†…å­˜å ç”¨</th>
                        <th>æ¨èåº¦</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>å½“å‰Simple Queue</strong></td>
                        <td class="metric-danger">500</td>
                        <td class="metric-danger">1K/s</td>
                        <td class="metric-warning">50ms</td>
                        <td class="metric-danger">90%+</td>
                        <td class="metric-warning">2GB</td>
                        <td class="metric-danger">âŒ ä¸æ¨è</td>
                    </tr>
                    <tr>
                        <td><strong>Nginx + Redis</strong></td>
                        <td class="metric-good">10K</td>
                        <td class="metric-good">50K/s</td>
                        <td class="metric-good">10ms</td>
                        <td class="metric-good">60%</td>
                        <td class="metric-good">4GB</td>
                        <td class="metric-good">âœ… æ¨è</td>
                    </tr>
                    <tr>
                        <td><strong>Docker Swarm + AutoMQ</strong></td>
                        <td class="metric-good">50K</td>
                        <td class="metric-good">200K/s</td>
                        <td class="metric-good">5ms</td>
                        <td class="metric-good">45%</td>
                        <td class="metric-good">6GB</td>
                        <td class="metric-good">âœ… å¼ºçƒˆæ¨è</td>
                    </tr>
                    <tr>
                        <td><strong>K8s + RocketMQ</strong></td>
                        <td class="metric-good">100K</td>
                        <td class="metric-good">500K/s</td>
                        <td class="metric-good">3ms</td>
                        <td class="metric-good">40%</td>
                        <td class="metric-good">8GB</td>
                        <td class="metric-good">ğŸš€ ä¼ä¸šçº§</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- ç›‘æ§æ–¹æ¡ˆ -->
        <div class="section">
            <h2><span class="emoji">ğŸ“ˆ</span> å®æ—¶ç›‘æ§æ–¹æ¡ˆ</h2>
            
            <div class="monitor-grid">
                <div class="monitor-card">
                    <h4>ğŸ“Š ç³»ç»Ÿç›‘æ§</h4>
                    <div class="monitor-value">Prometheus</div>
                    <p>CPUã€å†…å­˜ã€ç½‘ç»œ</p>
                </div>
                <div class="monitor-card">
                    <h4>ğŸ“ˆ åº”ç”¨ç›‘æ§</h4>
                    <div class="monitor-value">Grafana</div>
                    <p>QPSã€å»¶è¿Ÿã€é”™è¯¯ç‡</p>
                </div>
                <div class="monitor-card">
                    <h4>ğŸ“‹ æ—¥å¿—åˆ†æ</h4>
                    <div class="monitor-value">ELK Stack</div>
                    <p>è¯·æ±‚æ—¥å¿—ã€é”™è¯¯è¿½è¸ª</p>
                </div>
                <div class="monitor-card">
                    <h4>ğŸš¨ å‘Šè­¦ç³»ç»Ÿ</h4>
                    <div class="monitor-value">AlertManager</div>
                    <p>é˜ˆå€¼å‘Šè­¦ã€é€šçŸ¥</p>
                </div>
            </div>

            <div class="code-example">
# prometheusé…ç½®ç¤ºä¾‹
# docker-compose.yml
version: '3.8'
services:
  prometheus:
    image: prom/prometheus
    ports:
      - "9090:9090"
    volumes:
      - ./prometheus.yml:/etc/prometheus/prometheus.yml
      
  grafana:
    image: grafana/grafana
    ports:
      - "3000:3000"
    environment:
      - GF_SECURITY_ADMIN_PASSWORD=admin

# å…³é”®ç›‘æ§æŒ‡æ ‡
- vtox_requests_total{method="POST", endpoint="/api/fault_data"}
- vtox_request_duration_seconds
- vtox_queue_size{queue="fault_data"}
- vtox_cpu_usage_percent
- vtox_memory_usage_bytes
            </div>
        </div>

        <!-- å®æ–½æ—¶é—´çº¿ -->
        <div class="section">
            <h2><span class="emoji">ğŸ—“ï¸</span> å®æ–½æ—¶é—´çº¿</h2>
            
            <div class="timeline">
                <h3 style="color: white; text-align: center; margin-bottom: 25px;">âš¡ å¿«é€Ÿå®æ–½è·¯çº¿å›¾</h3>
                
                <div class="timeline-step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <h4>ç¬¬1å¤©: è½¦è¾†æ¨¡æ‹Ÿå™¨å¼€å‘</h4>
                        <p>å¼€å‘é«˜å¹¶å‘è½¦è¾†æ•°æ®æ¨¡æ‹Ÿå™¨ï¼Œæ”¯æŒ10ç«¯å£Ã—100è½¦é…ç½®</p>
                        <div class="command-box">
python vehicle_simulator.py --ports=10 --cars_per_port=100 --frequency=100
                        </div>
                    </div>
                </div>
                
                <div class="timeline-step">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <h4>ç¬¬2å¤©: è´Ÿè½½å‡è¡¡é…ç½®</h4>
                        <p>éƒ¨ç½²Nginxè´Ÿè½½å‡è¡¡ï¼Œé…ç½®åç«¯æœåŠ¡é›†ç¾¤</p>
                        <div class="command-box">
docker-compose up -d nginx backend1 backend2 backend3
                        </div>
                    </div>
                </div>
                
                <div class="timeline-step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <h4>ç¬¬3å¤©: æ¶ˆæ¯é˜Ÿåˆ—å‡çº§</h4>
                        <p>éƒ¨ç½²Redisé›†ç¾¤æˆ–AutoMQï¼Œæ›¿æ¢Simple Queue</p>
                        <div class="command-box">
# Redisé›†ç¾¤
docker-compose -f redis-cluster.yml up -d

# æˆ–è€…AutoMQ
docker run -d automq/automq-cluster
                        </div>
                    </div>
                </div>
                
                <div class="timeline-step">
                    <div class="step-number">4</div>
                    <div class="step-content">
                        <h4>ç¬¬4å¤©: ç›‘æ§ç³»ç»Ÿæ­å»º</h4>
                        <p>éƒ¨ç½²Prometheus + Grafanaç›‘æ§æ–¹æ¡ˆ</p>
                        <div class="command-box">
docker-compose -f monitoring.yml up -d prometheus grafana
                        </div>
                    </div>
                </div>
                
                <div class="timeline-step">
                    <div class="step-number">5</div>
                    <div class="step-content">
                        <h4>ç¬¬5å¤©: å‹åŠ›æµ‹è¯•ä¸ä¼˜åŒ–</h4>
                        <p>å…¨é“¾è·¯å‹åŠ›æµ‹è¯•ï¼Œæ€§èƒ½è°ƒä¼˜</p>
                        <div class="command-box">
# å¯åŠ¨1000è½¦æ¨¡æ‹Ÿ
python load_test.py --vehicles=1000 --duration=3600

# ç›‘æ§æ€§èƒ½æŒ‡æ ‡
curl http://localhost:9090/metrics
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ä»£ç å®ç° -->
        <div class="section">
            <h2><span class="emoji">ğŸ’»</span> æ ¸å¿ƒä»£ç å®ç°</h2>
            
            <h3><span class="emoji">ğŸš—</span> è½¦è¾†æ¨¡æ‹Ÿå™¨æ ¸å¿ƒä»£ç </h3>
            <div class="code-example">
# vehicle_simulator.py - å®Œæ•´å®ç°
import asyncio
import aiohttp
import json
import time
import random
import argparse
from concurrent.futures import ProcessPoolExecutor
import multiprocessing as mp

class VehicleDataGenerator:
    """è½¦è¾†æ•°æ®ç”Ÿæˆå™¨"""
    
    @staticmethod
    def generate_fault_data():
        """ç”Ÿæˆæ•…éšœè¯Šæ–­æ•°æ®"""
        return {
            "timestamp": time.time(),
            "Ia": random.uniform(-10, 10),
            "Ib": random.uniform(-10, 10), 
            "Ic": random.uniform(-10, 10),
            "Va": random.uniform(200, 240),
            "Vb": random.uniform(200, 240),
            "Vc": random.uniform(200, 240),
            "frequency": random.uniform(49.5, 50.5),
            "temperature": random.uniform(60, 90),
            "vibration_x": random.uniform(0, 5),
            "vibration_y": random.uniform(0, 5),
            "vibration_z": random.uniform(0, 5)
        }
    
    @staticmethod
    def generate_vehicle_data(vehicle_id):
        """ç”Ÿæˆå®Œæ•´è½¦è¾†æ•°æ®"""
        return {
            "vehicle_id": f"CAR_{vehicle_id:06d}",
            "timestamp": time.time(),
            "gps": {
                "latitude": random.uniform(39.9, 40.1),
                "longitude": random.uniform(116.3, 116.5),
                "speed": random.uniform(0, 120),
                "direction": random.uniform(0, 360)
            },
            "engine": {
                "rpm": random.uniform(800, 6000),
                "temperature": random.uniform(80, 95),
                "oil_pressure": random.uniform(2, 6)
            },
            "battery": {
                "voltage": random.uniform(11.5, 12.8),
                "current": random.uniform(-50, 50),
                "temperature": random.uniform(20, 45)
            },
            "fault_data": VehicleDataGenerator.generate_fault_data()
        }

class HighConcurrencySimulator:
    """é«˜å¹¶å‘è½¦è¾†æ¨¡æ‹Ÿå™¨"""
    
    def __init__(self, target_url="http://localhost/api/fault_data", 
                 total_vehicles=1000, frequency=100, processes=10):
        self.target_url = target_url
        self.total_vehicles = total_vehicles
        self.frequency = frequency  # Hz
        self.processes = processes
        self.vehicles_per_process = total_vehicles // processes
        
    async def simulate_single_vehicle(self, vehicle_id, session):
        """æ¨¡æ‹Ÿå•ä¸ªè½¦è¾†æ•°æ®å‘é€"""
        interval = 1.0 / self.frequency  # å‘é€é—´éš”
        
        while True:
            try:
                data = VehicleDataGenerator.generate_vehicle_data(vehicle_id)
                
                async with session.post(self.target_url, json=data) as response:
                    if response.status != 200:
                        print(f"Vehicle {vehicle_id} got {response.status}")
                
                await asyncio.sleep(interval)
                
            except Exception as e:
                print(f"Vehicle {vehicle_id} error: {e}")
                await asyncio.sleep(1)  # é”™è¯¯åé‡è¯•
    
    async def run_vehicle_group(self, start_id, count):
        """è¿è¡Œä¸€ç»„è½¦è¾†"""
        print(f"Starting {count} vehicles from ID {start_id}")
        
        # ä½¿ç”¨è¿æ¥æ± ä¼˜åŒ–
        connector = aiohttp.TCPConnector(
            limit=500,  # æ€»è¿æ¥æ•°é™åˆ¶
            limit_per_host=100,  # æ¯ä¸»æœºè¿æ¥æ•°
            keepalive_timeout=30,
            enable_cleanup_closed=True
        )
        
        timeout = aiohttp.ClientTimeout(total=5, connect=2)
        
        async with aiohttp.ClientSession(
            connector=connector, 
            timeout=timeout
        ) as session:
            
            # åˆ›å»ºæ‰€æœ‰è½¦è¾†ä»»åŠ¡
            tasks = []
            for i in range(count):
                vehicle_id = start_id + i
                task = asyncio.create_task(
                    self.simulate_single_vehicle(vehicle_id, session)
                )
                tasks.append(task)
            
            # ç­‰å¾…æ‰€æœ‰ä»»åŠ¡
            await asyncio.gather(*tasks)
    
    def start_simulation(self):
        """å¯åŠ¨å®Œæ•´æ¨¡æ‹Ÿ"""
        print(f"ğŸš€ å¯åŠ¨é«˜å¹¶å‘æ¨¡æ‹Ÿå™¨")
        print(f"ğŸ“Š è½¦è¾†æ€»æ•°: {self.total_vehicles}")
        print(f"âš¡ å‘é€é¢‘ç‡: {self.frequency} Hz")
        print(f"ğŸ”§ è¿›ç¨‹æ•°: {self.processes}")
        print(f"ğŸ“ ç›®æ ‡URL: {self.target_url}")
        
        # å¤šè¿›ç¨‹å¹¶å‘
        with ProcessPoolExecutor(max_workers=self.processes) as executor:
            futures = []
            
            for i in range(self.processes):
                start_id = i * self.vehicles_per_process
                count = self.vehicles_per_process
                
                future = executor.submit(
                    self._run_in_process, start_id, count
                )
                futures.append(future)
            
            # ç­‰å¾…æ‰€æœ‰è¿›ç¨‹å®Œæˆ
            for future in futures:
                future.result()
    
    def _run_in_process(self, start_id, count):
        """åœ¨å•ä¸ªè¿›ç¨‹ä¸­è¿è¡Œ"""
        try:
            # æ¯ä¸ªè¿›ç¨‹ç‹¬ç«‹çš„äº‹ä»¶å¾ªç¯
            loop = asyncio.new_event_loop()
            asyncio.set_event_loop(loop)
            
            loop.run_until_complete(
                self.run_vehicle_group(start_id, count)
            )
        except KeyboardInterrupt:
            print(f"Process {mp.current_process().name} stopped")
        finally:
            loop.close()

if __name__ == "__main__":
    parser = argparse.ArgumentParser(description='é«˜å¹¶å‘è½¦è¾†æ•°æ®æ¨¡æ‹Ÿå™¨')
    parser.add_argument('--vehicles', type=int, default=1000, help='è½¦è¾†æ€»æ•°')
    parser.add_argument('--frequency', type=int, default=100, help='å‘é€é¢‘ç‡(Hz)')
    parser.add_argument('--processes', type=int, default=10, help='è¿›ç¨‹æ•°')
    parser.add_argument('--url', type=str, default='http://localhost/api/fault_data', help='ç›®æ ‡URL')
    
    args = parser.parse_args()
    
    simulator = HighConcurrencySimulator(
        target_url=args.url,
        total_vehicles=args.vehicles,
        frequency=args.frequency,
        processes=args.processes
    )
    
    try:
        simulator.start_simulation()
    except KeyboardInterrupt:
        print("\nğŸ›‘ æ¨¡æ‹Ÿå™¨å·²åœæ­¢")
            </div>

            <h3><span class="emoji">ğŸ³</span> Docker Compose å®Œæ•´é…ç½®</h3>
            <div class="code-example">
# docker-compose.yml - å®Œæ•´éƒ¨ç½²æ–¹æ¡ˆ
version: '3.8'

services:
  # Nginx è´Ÿè½½å‡è¡¡
  nginx:
    image: nginx:alpine
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf
      - ./nginx.conf.d:/etc/nginx/conf.d
    depends_on:
      - backend1
      - backend2
      - backend3
    restart: unless-stopped

  # åç«¯æœåŠ¡é›†ç¾¤
  backend1:
    build: .
    environment:
      - INSTANCE_ID=backend1
      - REDIS_URL=redis://redis-cluster:6379
    depends_on:
      - redis-cluster
      - postgres
    restart: unless-stopped

  backend2:
    build: .
    environment:
      - INSTANCE_ID=backend2
      - REDIS_URL=redis://redis-cluster:6379
    depends_on:
      - redis-cluster
      - postgres
    restart: unless-stopped

  backend3:
    build: .
    environment:
      - INSTANCE_ID=backend3
      - REDIS_URL=redis://redis-cluster:6379
    depends_on:
      - redis-cluster
      - postgres
    restart: unless-stopped

  # Redis é›†ç¾¤
  redis-cluster:
    image: redis:7-alpine
    command: redis-server --appendonly yes --cluster-enabled yes
    ports:
      - "6379:6379"
    volumes:
      - redis_data:/data
    restart: unless-stopped

  # PostgreSQL æ•°æ®åº“
  postgres:
    image: postgres:15-alpine
    environment:
      POSTGRES_DB: vtox
      POSTGRES_USER: vtox
      POSTGRES_PASSWORD: vtox123
    volumes:
      - postgres_data:/var/lib/postgresql/data
    ports:
      - "5432:5432"
    restart: unless-stopped

  # Prometheus ç›‘æ§
  prometheus:
    image: prom/prometheus
    ports:
      - "9090:9090"
    volumes:
      - ./prometheus.yml:/etc/prometheus/prometheus.yml
      - prometheus_data:/prometheus
    restart: unless-stopped

  # Grafana å¯è§†åŒ–
  grafana:
    image: grafana/grafana
    ports:
      - "3000:3000"
    environment:
      - GF_SECURITY_ADMIN_PASSWORD=admin123
    volumes:
      - grafana_data:/var/lib/grafana
    restart: unless-stopped

  # InfluxDB æ—¶åºæ•°æ®åº“
  influxdb:
    image: influxdb:2.7-alpine
    ports:
      - "8086:8086"
    environment:
      - DOCKER_INFLUXDB_INIT_MODE=setup
      - DOCKER_INFLUXDB_INIT_USERNAME=admin
      - DOCKER_INFLUXDB_INIT_PASSWORD=admin123
      - DOCKER_INFLUXDB_INIT_ORG=vtox
      - DOCKER_INFLUXDB_INIT_BUCKET=vehicle_data
    volumes:
      - influxdb_data:/var/lib/influxdb2
    restart: unless-stopped

volumes:
  redis_data:
  postgres_data:
  prometheus_data:
  grafana_data:
  influxdb_data:

# å¯åŠ¨å‘½ä»¤:
# docker-compose up -d
# docker-compose ps
# docker-compose logs -f backend1
            </div>
        </div>

        <!-- æ€§èƒ½ä¼˜åŒ–å»ºè®® -->
        <div class="section">
            <h2><span class="emoji">ğŸ”§</span> è¿›ä¸€æ­¥ä¼˜åŒ–å»ºè®®</h2>
            
            <div class="implementation-grid">
                <div class="impl-card">
                    <h4><span class="emoji">âš¡</span> 1. å¼‚æ­¥ä¼˜åŒ–</h4>
                    <ul style="margin-left: 20px;">
                        <li><strong>uvloop:</strong> ä½¿ç”¨é«˜æ€§èƒ½äº‹ä»¶å¾ªç¯</li>
                        <li><strong>aiohttp:</strong> å¼‚æ­¥HTTPå®¢æˆ·ç«¯</li>
                        <li><strong>asyncpg:</strong> å¼‚æ­¥æ•°æ®åº“é©±åŠ¨</li>
                        <li><strong>æ‰¹å¤„ç†:</strong> æ‰¹é‡å¤„ç†æ•°æ®åº“æ“ä½œ</li>
                    </ul>
                </div>
                
                <div class="impl-card">
                    <h4><span class="emoji">ğŸ”„</span> 2. ç¼“å­˜ç­–ç•¥</h4>
                    <ul style="margin-left: 20px;">
                        <li><strong>Redisç¼“å­˜:</strong> çƒ­ç‚¹æ•°æ®ç¼“å­˜</li>
                        <li><strong>æœ¬åœ°ç¼“å­˜:</strong> åº”ç”¨çº§ç¼“å­˜</li>
                        <li><strong>CDN:</strong> é™æ€èµ„æºåŠ é€Ÿ</li>
                        <li><strong>æ•°æ®é¢„çƒ­:</strong> é¢„åŠ è½½å¸¸ç”¨æ•°æ®</li>
                    </ul>
                </div>
                
                <div class="impl-card">
                    <h4><span class="emoji">ğŸ“Š</span> 3. æ•°æ®åº“ä¼˜åŒ–</h4>
                    <ul style="margin-left: 20px;">
                        <li><strong>è¿æ¥æ± :</strong> æ•°æ®åº“è¿æ¥å¤ç”¨</li>
                        <li><strong>è¯»å†™åˆ†ç¦»:</strong> ä¸»ä»æ•°æ®åº“</li>
                        <li><strong>åˆ†åº“åˆ†è¡¨:</strong> æ°´å¹³åˆ†ç‰‡</li>
                        <li><strong>ç´¢å¼•ä¼˜åŒ–:</strong> æŸ¥è¯¢æ€§èƒ½ä¼˜åŒ–</li>
                    </ul>
                </div>
                
                <div class="impl-card">
                    <h4><span class="emoji">ğŸŒ</span> 4. å®¹å™¨åŒ–éƒ¨ç½²</h4>
                    <ul style="margin-left: 20px;">
                        <li><strong>Docker Swarm:</strong> å®¹å™¨ç¼–æ’</li>
                        <li><strong>Kubernetes:</strong> ä¼ä¸šçº§éƒ¨ç½²</li>
                        <li><strong>è‡ªåŠ¨æ‰©ç¼©å®¹:</strong> å¼¹æ€§ä¼¸ç¼©</li>
                        <li><strong>å¥åº·æ£€æŸ¥:</strong> è‡ªåŠ¨æ•…éšœæ¢å¤</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- é¢„æœŸæ•ˆæœ -->
        <div class="section">
            <h2><span class="emoji">ğŸ¯</span> é¢„æœŸæ€§èƒ½æ•ˆæœ</h2>
            
            <div class="highlight-box">
                <h4>ğŸš€ æ€§èƒ½æå‡é¢„æœŸ</h4>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin: 25px 0;">
                    <div>
                        <div class="highlight-number">1000x</div>
                        <p>å¹¶å‘å¤„ç†èƒ½åŠ›æå‡</p>
                    </div>
                    <div>
                        <div class="highlight-number">10x</div>
                        <p>å“åº”é€Ÿåº¦æå‡</p>
                    </div>
                    <div>
                        <div class="highlight-number">99.9%</div>
                        <p>ç³»ç»Ÿå¯ç”¨æ€§ä¿è¯</p>
                    </div>
                    <div>
                        <div class="highlight-number">100K</div>
                        <p>æ¶ˆæ¯/ç§’å¤„ç†èƒ½åŠ›</p>
                    </div>
                </div>
            </div>

            <h3><span class="emoji">ğŸ“ˆ</span> å…³é”®æŒ‡æ ‡å¯¹æ¯”</h3>
            <table class="performance-table">
                <thead>
                    <tr>
                        <th>æ€§èƒ½æŒ‡æ ‡</th>
                        <th>ä¼˜åŒ–å‰</th>
                        <th>ä¼˜åŒ–å</th>
                        <th>æå‡å€æ•°</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>åŒæ—¶åœ¨çº¿è½¦è¾†</strong></td>
                        <td class="metric-danger">100</td>
                        <td class="metric-good">1000+</td>
                        <td class="metric-good">10x</td>
                    </tr>
                    <tr>
                        <td><strong>æ¶ˆæ¯å¤„ç†é€Ÿç‡</strong></td>
                        <td class="metric-danger">1K msg/s</td>
                        <td class="metric-good">100K msg/s</td>
                        <td class="metric-good">100x</td>
                    </tr>
                    <tr>
                        <td><strong>ç³»ç»Ÿå“åº”æ—¶é—´</strong></td>
                        <td class="metric-warning">100ms</td>
                        <td class="metric-good">10ms</td>
                        <td class="metric-good">10x</td>
                    </tr>
                    <tr>
                        <td><strong>CPUåˆ©ç”¨ç‡</strong></td>
                        <td class="metric-danger">90%+</td>
                        <td class="metric-good">60%</td>
                        <td class="metric-good">ä¼˜åŒ–50%</td>
                    </tr>
                    <tr>
                        <td><strong>å†…å­˜ä½¿ç”¨</strong></td>
                        <td class="metric-warning">4GB</td>
                        <td class="metric-good">8GB</td>
                        <td class="metric-good">æ›´é«˜æ•ˆ</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- é¡µè„š -->
        <div style="background: rgba(255, 255, 255, 0.95); border-radius: 15px; padding: 30px; text-align: center; margin-top: 30px;">
            <p><strong>VTOX é«˜å¹¶å‘è´Ÿè½½å‡è¡¡ä¼˜åŒ–æ–¹æ¡ˆ</strong></p>
            <p>æŠ¥å‘Šç”Ÿæˆæ—¶é—´: 2024å¹´12æœˆ | é¡¹ç›®: è½¦è”ç½‘æ•…éšœè¯Šæ–­ç³»ç»Ÿ</p>
            <p style="color: #3498db; margin-top: 15px;">
                ğŸ“§ æŠ€æœ¯æ”¯æŒ: vtox-tech@company.com | ğŸ“ æŠ€æœ¯çƒ­çº¿: 400-123-4567<br>
                ğŸŒ é¡¹ç›®åœ°å€: https://github.com/your-org/vtox | ğŸš€ ç«‹å³å¼€å§‹ä¼˜åŒ–
            </p>
        </div>
    </div>
</body>
</html> 