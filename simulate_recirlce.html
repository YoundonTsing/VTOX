<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>电机故障诊断系统 - 三方协调实现架构</title>
    <style>
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        h1 {
            color: #1e3a8a;
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #1e3a8a;
            padding-bottom: 10px;
        }
        h2 {
            color: #2563eb;
            margin-top: 30px;
            border-left: 5px solid #2563eb;
            padding-left: 15px;
        }
        h3 {
            color: #3b82f6;
            margin-top: 20px;
        }
        .architecture-diagram {
            display: flex;
            justify-content: space-between;
            margin: 30px 0;
            text-align: center;
        }
        .component {
            flex: 1;
            margin: 0 10px;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .data-source {
            background-color: #dbeafe;
            border-top: 4px solid #3b82f6;
        }
        .backend {
            background-color: #e0f2fe;
            border-top: 4px solid #0ea5e9;
        }
        .frontend {
            background-color: #f0f9ff;
            border-top: 4px solid #0284c7;
        }
        .flow-diagram {
            margin: 30px 0;
            padding: 20px;
            background-color: #f8fafc;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }
        .flow-step {
            margin: 15px 0;
            padding: 10px;
            background-color: #fff;
            border-left: 3px solid #3b82f6;
        }
        .tech-details {
            background-color: #f1f5f9;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        .tech-item {
            margin-bottom: 15px;
        }
        .tech-title {
            font-weight: bold;
            color: #0f172a;
        }
        .code-block {
            background-color: #0f172a;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-family: monospace;
            margin: 10px 0;
        }
        .highlight {
            background-color: #fef9c3;
            padding: 2px 5px;
            border-radius: 3px;
        }
        .diagram-container {
            text-align: center;
            margin: 30px 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #e2e8f0;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #f1f5f9;
            font-weight: bold;
        }
        tr:nth-child(even) {
            background-color: #f8fafc;
        }
    </style>
</head>
<body>
    <h1>电机故障诊断系统 - 三方协调实现架构</h1>
    
    <div class="architecture-diagram">
        <div class="component data-source">
            <h3>模拟数据源</h3>
            <p>生成电机运行数据</p>
            <p>模拟各类故障信号</p>
            <p>数据格式化与发送</p>
        </div>
        <div style="display: flex; align-items: center;">
            <div>→→→</div>
        </div>
        <div class="component backend">
            <h3>后端服务</h3>
            <p>数据接收与预处理</p>
            <p>故障诊断算法</p>
            <p>分析结果生成</p>
        </div>
        <div style="display: flex; align-items: center;">
            <div>→→→</div>
        </div>
        <div class="component frontend">
            <h3>前端界面</h3>
            <p>数据可视化展示</p>
            <p>用户交互界面</p>
            <p>实时监测与告警</p>
        </div>
    </div>

    <h2>1. 通信方案详解</h2>
    
    <div class="tech-details">
        <div class="tech-item">
            <div class="tech-title">数据源到后端通信</div>
            <ul>
                <li><strong>HTTP请求</strong>: 用于批量数据上传和非实时场景</li>
                <li><strong>WebSocket</strong>: 用于实时数据流传输，减少连接开销</li>
                <li><strong>数据格式</strong>: 标准化JSON格式，包含时间戳、测量值和元数据</li>
            </ul>
            <div class="code-block">
                // 匝间短路模拟数据示例
                {
                  "timestamp": "2023-11-15T09:32:11.000Z",
                  "device_id": "motor_01",
                  "measurements": {
                    "current_phase_a": [1.2, 1.3, 1.4, ...],
                    "current_phase_b": [1.1, 1.2, 1.3, ...],
                    "current_phase_c": [1.3, 1.4, 1.5, ...],
                    "voltage_phase_a": [220.1, 220.2, 220.1, ...],
                    "sampling_rate": 10000
                  },
                  "metadata": {
                    "motor_type": "induction",
                    "rated_power": 75,
                    "rated_voltage": 380
                  }
                }
            </div>
        </div>
        
        <div class="tech-item">
            <div class="tech-title">后端到前端通信</div>
            <ul>
                <li><strong>RESTful API</strong>: 用于请求分析结果和历史数据</li>
                <li><strong>WebSocket</strong>: 用于推送实时监测数据和告警信息</li>
                <li><strong>响应格式</strong>: 包含诊断结果、可视化数据和元数据的JSON</li>
            </ul>
            <div class="code-block">
                // 匝间短路诊断结果示例
                {
                  "diagnosis": {
                    "fault_type": "turn_to_turn_fault",
                    "score": 0.78,
                    "status": "FAULT",
                    "confidence": 0.92,
                    "details": "检测到定子绕组匝间短路特征频率"
                  },
                  "visualizations": {
                    "time_series": {
                      "time": [0, 0.001, 0.002, ...],
                      "values": [1.2, 1.3, 1.4, ...]
                    },
                    "frequency_spectrum": {
                      "frequency": [0, 10, 20, ...],
                      "amplitude": [0.01, 0.02, 0.15, ...]
                    }
                  },
                  "timestamp": "2023-11-15T09:32:11.000Z"
                }
            </div>
        </div>
        
        <div class="tech-item">
            <div class="tech-title">通信安全与优化</div>
            <ul>
                <li><strong>认证机制</strong>: JWT令牌认证，确保API安全</li>
                <li><strong>数据压缩</strong>: 对大型数据集使用gzip压缩</li>
                <li><strong>连接管理</strong>: 心跳检测和自动重连机制</li>
                <li><strong>错误处理</strong>: 标准化错误响应格式和重试策略</li>
            </ul>
        </div>
    </div>

    <h2>2. 匝间短路诊断算法</h2>
    
    <div class="tech-details">
        <div class="tech-item">
            <div class="tech-title">基于MCSA的匝间短路检测原理</div>
            <p>匝间短路诊断主要基于电机电流特征分析(MCSA)技术，通过分析电流信号中的特征频率成分来识别故障。</p>
            
            <h4>核心算法流程:</h4>
            <ol>
                <li><strong>信号获取</strong>: 采集三相电流信号</li>
                <li><strong>信号预处理</strong>: 滤波、去噪和归一化</li>
                <li><strong>频谱分析</strong>: 使用FFT将时域信号转换为频域</li>
                <li><strong>特征提取</strong>: 提取与匝间短路相关的特征频率分量</li>
                <li><strong>故障判断</strong>: 基于特征频率幅值与阈值比较</li>
            </ol>
            
            <h4>匝间短路特征频率:</h4>
            <div class="code-block">
                f_stf = f_s * [n(1-s) ± k]
                
                其中:
                f_stf: 匝间短路特征频率
                f_s: 电源频率
                n: 1, 3, 5, 7... (奇数谐波)
                s: 转差率
                k: 1, 3, 5, 7... (奇数)
            </div>
            
            <h4>故障评分计算:</h4>
            <div class="code-block">
                score = Σ(A_i / A_f) * w_i
                
                其中:
                A_i: 特征频率分量的幅值
                A_f: 基频幅值
                w_i: 权重系数
            </div>
        </div>
        
        <div class="tech-item">
            <div class="tech-title">算法优化与增强</div>
            <ul>
                <li><strong>自适应阈值</strong>: 根据电机运行状态动态调整判断阈值</li>
                <li><strong>多特征融合</strong>: 结合多个特征频率的综合分析</li>
                <li><strong>机器学习增强</strong>: 使用SVM/随机森林等模型提高诊断准确率</li>
                <li><strong>抗干扰处理</strong>: 识别并过滤负载波动和电网谐波干扰</li>
            </ul>
        </div>
        
        <div class="tech-item">
            <div class="tech-title">实时性能优化</div>
            <ul>
                <li><strong>滑动窗口分析</strong>: 使用重叠窗口实现连续监测</li>
                <li><strong>并行计算</strong>: 利用多核处理器加速FFT计算</li>
                <li><strong>增量分析</strong>: 只处理新增数据，减少计算冗余</li>
                <li><strong>预警机制</strong>: 多级阈值设置，实现早期故障预警</li>
            </ul>
        </div>
    </div>

    <h2>3. 工作流程图</h2>
    
    <div class="flow-diagram">
        <h3>匝间短路实时监测工作流程</h3>
        
        <div class="flow-step">
            <strong>步骤1: 数据采集与发送</strong>
            <ul>
                <li>模拟数据源生成带有匝间短路特征的三相电流数据</li>
                <li>数据按照预设采样率(如10kHz)进行采集</li>
                <li>将数据打包为JSON格式</li>
                <li>通过WebSocket连接实时发送到后端服务器</li>
            </ul>
        </div>
        
        <div class="flow-step">
            <strong>步骤2: 数据接收与缓存</strong>
            <ul>
                <li>后端WebSocket服务接收实时数据流</li>
                <li>将数据存入缓冲区，按照时间窗口(如1秒)进行分组</li>
                <li>对数据进行初步验证，检查完整性和格式</li>
                <li>将有效数据传递给分析模块</li>
            </ul>
        </div>
        
        <div class="flow-step">
            <strong>步骤3: 数据预处理</strong>
            <ul>
                <li>对原始电流信号进行滤波，去除高频噪声</li>
                <li>进行信号归一化，消除幅值差异影响</li>
                <li>应用汉宁窗等窗函数，减少频谱泄漏</li>
                <li>计算三相电流的对称分量(正序、负序、零序)</li>
            </ul>
        </div>
        
        <div class="flow-step">
            <strong>步骤4: 频谱分析</strong>
            <ul>
                <li>对预处理后的信号执行快速傅里叶变换(FFT)</li>
                <li>计算频谱的幅值和相位信息</li>
                <li>识别基频(通常为50Hz或60Hz)及其谐波</li>
                <li>提取与匝间短路相关的特征频率分量</li>
            </ul>
        </div>
        
        <div class="flow-step">
            <strong>步骤5: 故障诊断</strong>
            <ul>
                <li>计算特征频率分量与基频幅值的比值</li>
                <li>根据预设阈值判断是否存在匝间短路故障</li>
                <li>计算故障评分和置信度</li>
                <li>生成包含诊断结果和可视化数据的JSON响应</li>
            </ul>
        </div>
        
        <div class="flow-step">
            <strong>步骤6: 结果推送</strong>
            <ul>
                <li>将诊断结果通过WebSocket推送给前端</li>
                <li>将原始数据和分析结果存入数据库(用于历史查询)</li>
                <li>如果检测到故障，触发告警机制</li>
                <li>更新系统状态和统计信息</li>
            </ul>
        </div>
        
        <div class="flow-step">
            <strong>步骤7: 前端展示</strong>
            <ul>
                <li>前端接收实时推送的诊断结果</li>
                <li>更新仪表盘上的状态指示器和统计数据</li>
                <li>使用ECharts绘制时序图和频谱图</li>
                <li>如有故障，显示告警信息并高亮相关区域</li>
                <li>将诊断结果保存到localStorage，用于离线查看</li>
            </ul>
        </div>
    </div>

    <h2>4. 系统性能与可扩展性</h2>
    
    <div class="tech-details">
        <div class="tech-item">
            <div class="tech-title">性能指标</div>
            <table>
                <tr>
                    <th>指标</th>
                    <th>目标值</th>
                    <th>实现方法</th>
                </tr>
                <tr>
                    <td>实时响应延迟</td>
                    <td>< 200ms</td>
                    <td>WebSocket通信 + 高效算法实现</td>
                </tr>
                <tr>
                    <td>诊断准确率</td>
                    <td>> 95%</td>
                    <td>多特征融合 + 机器学习增强</td>
                </tr>
                <tr>
                    <td>并发处理能力</td>
                    <td>50+ 设备同时监测</td>
                    <td>异步处理 + 负载均衡</td>
                </tr>
                <tr>
                    <td>数据处理吞吐量</td>
                    <td>> 10MB/s</td>
                    <td>数据压缩 + 流式处理</td>
                </tr>
            </table>
        </div>
        
        <div class="tech-item">
            <div class="tech-title">可扩展性设计</div>
            <ul>
                <li><strong>模块化架构</strong>: 各功能模块松耦合，便于扩展</li>
                <li><strong>插件化诊断算法</strong>: 可动态加载不同故障类型的诊断算法</li>
                <li><strong>分布式部署</strong>: 支持水平扩展，应对大规模设备监测</li>
                <li><strong>微服务架构</strong>: 将数据采集、分析、存储等功能拆分为独立服务</li>
            </ul>
        </div>
    </div>

    <h2>5. 应用场景与价值</h2>
    
    <div class="tech-details">
        <div class="tech-item">
            <div class="tech-title">典型应用场景</div>
            <ul>
                <li><strong>工业生产线</strong>: 实时监测生产设备电机健康状态</li>
                <li><strong>电力系统</strong>: 监测发电机、电动机等关键设备</li>
                <li><strong>智能建筑</strong>: 监测电梯、空调等设备的电机状态</li>
                <li><strong>新能源领域</strong>: 风力发电机组和光伏逆变器监测</li>
            </ul>
        </div>
        
        <div class="tech-item">
            <div class="tech-title">系统价值</div>
            <ul>
                <li><strong>预防性维护</strong>: 早期发现故障隐患，避免突发停机</li>
                <li><strong>延长设备寿命</strong>: 通过及时维护，延长电机使用寿命</li>
                <li><strong>降低维护成本</strong>: 减少不必要的检修，实现按需维护</li>
                <li><strong>提高生产效率</strong>: 减少意外停机时间，提高设备可用率</li>
                <li><strong>数据价值挖掘</strong>: 积累历史数据，为设备优化提供依据</li>
            </ul>
        </div>
    </div>
    
    <h2>6. 未来发展方向</h2>
    
    <div class="tech-details">
        <div class="tech-item">
            <div class="tech-title">技术升级路线</div>
            <ul>
                <li><strong>深度学习应用</strong>: 引入CNN/RNN等深度学习模型提高诊断准确率</li>
                <li><strong>多传感器融合</strong>: 结合振动、温度等多种传感器数据进行综合诊断</li>
                <li><strong>边缘计算</strong>: 将部分分析功能下沉到边缘设备，减轻服务器负担</li>
                <li><strong>数字孪生</strong>: 构建电机数字孪生模型，实现更精确的故障预测</li>
            </ul>
        </div>
    </div>
</body>
</html>