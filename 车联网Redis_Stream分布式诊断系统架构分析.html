<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ”„ è½¦è”ç½‘Redis Streamåˆ†å¸ƒå¼è¯Šæ–­ç³»ç»Ÿ - å®Œæ•´æ¶æ„åˆ†æ</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <style>
        :root {
            --primary-color: #409EFF;
            --success-color: #67C23A;
            --warning-color: #E6A23C;
            --danger-color: #F56C6C;
            --info-color: #909399;
            --bg-color: #f8f9fa;
            --card-bg: #ffffff;
            --text-primary: #303133;
            --text-secondary: #606266;
            --border-color: #dcdfe6;
            --shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Microsoft YaHei', 'PingFang SC', 'Hiragino Sans GB', sans-serif;
            line-height: 1.6;
            color: var(--text-primary);
            background: var(--bg-color);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            padding: 40px 0;
            background: linear-gradient(135deg, var(--primary-color), #67C23A);
            color: white;
            margin-bottom: 30px;
            border-radius: 10px;
            box-shadow: var(--shadow);
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .nav {
            background: var(--card-bg);
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
            padding: 20px;
        }

        .nav ul {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            list-style: none;
        }

        .nav a {
            display: block;
            padding: 10px 20px;
            background: var(--primary-color);
            color: white;
            text-decoration: none;
            border-radius: 25px;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .nav a:hover {
            background: #328dff;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(64, 158, 255, 0.3);
        }

        .section {
            background: var(--card-bg);
            margin-bottom: 30px;
            border-radius: 10px;
            box-shadow: var(--shadow);
            overflow: hidden;
        }

        .section-header {
            background: linear-gradient(90deg, var(--primary-color), #67C23A);
            color: white;
            padding: 20px 30px;
            font-size: 1.5em;
            font-weight: 600;
        }

        .section-content {
            padding: 30px;
        }

        .problem-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .problem-card {
            background: var(--bg-color);
            border-radius: 8px;
            padding: 20px;
            border-left: 4px solid var(--danger-color);
        }

        .problem-card h4 {
            color: var(--danger-color);
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .solution-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .solution-card {
            background: var(--bg-color);
            border-radius: 8px;
            padding: 15px;
            border-left: 4px solid var(--success-color);
        }

        .solution-card h5 {
            color: var(--success-color);
            margin-bottom: 8px;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: var(--card-bg);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .comparison-table th,
        .comparison-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        .comparison-table th {
            background: var(--primary-color);
            color: white;
            font-weight: 600;
        }

        .comparison-table tr:nth-child(even) {
            background: var(--bg-color);
        }

        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.85em;
            font-weight: 500;
        }

        .status-success {
            background: rgba(103, 194, 58, 0.1);
            color: var(--success-color);
        }

        .status-error {
            background: rgba(245, 108, 108, 0.1);
            color: var(--danger-color);
        }

        .mermaid-container {
            background: var(--card-bg);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
            box-shadow: var(--shadow);
        }

        .code-block {
            background: #2d3748;
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            overflow-x: auto;
        }

        .data-structure {
            background: var(--bg-color);
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            border-left: 4px solid var(--info-color);
        }

        .data-structure h4 {
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 1.1em;
        }

        .flow-step {
            background: var(--bg-color);
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            border-left: 4px solid var(--warning-color);
        }

        .flow-step h4 {
            color: var(--warning-color);
            margin-bottom: 10px;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .metric-card {
            background: var(--card-bg);
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            box-shadow: var(--shadow);
            border-top: 3px solid var(--primary-color);
        }

        .metric-value {
            font-size: 2em;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 5px;
        }

        .metric-label {
            color: var(--text-secondary);
            font-size: 0.9em;
        }

        .highlight {
            background: linear-gradient(135deg, rgba(64, 158, 255, 0.1), rgba(103, 194, 58, 0.1));
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .nav ul {
                flex-direction: column;
            }
            
            .section-content {
                padding: 20px;
            }
            
            .comparison-table {
                font-size: 0.9em;
            }
        }

        .toc {
            background: var(--card-bg);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
        }

        .toc h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
        }

        .toc ul {
            list-style: none;
        }

        .toc li {
            margin-bottom: 8px;
        }

        .toc a {
            color: var(--text-primary);
            text-decoration: none;
            padding: 5px 10px;
            border-radius: 4px;
            transition: background 0.3s ease;
        }

        .toc a:hover {
            background: var(--bg-color);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ”„ è½¦è”ç½‘Redis Streamåˆ†å¸ƒå¼è¯Šæ–­ç³»ç»Ÿ</h1>
            <p>å®Œæ•´æ¶æ„åˆ†æä¸é—®é¢˜è§£å†³æ–¹æ¡ˆ - æ¡¥æ¥ç»„ä»¶ä¼˜åŒ–ç‰ˆ</p>
            <p style="margin-top: 10px; font-size: 14px; opacity: 0.9;">æœ€åæ›´æ–°: 2025-08-02 (v2.0 - æ¡¥æ¥ç»„ä»¶ä¿®å¤)</p>
        </div>

        <div class="toc">
            <h3>ğŸ“‘ ç›®å½•å¯¼èˆª</h3>
            <ul>
                <li><a href="#problems">âš¡ è§£å†³æ–¹æ¡ˆæ€»ç»“</a></li>
                <li><a href="#bridge-fix">ğŸ”§ æ¡¥æ¥ç»„ä»¶ä¿®å¤è¯¦è§£ (æœ€æ–°)</a></li>
                <li><a href="#architecture">ğŸ—ï¸ Redis Streamæ¶æ„å…¨æµç¨‹è¯¦è§£</a></li>
                <li><a href="#data-structures">ğŸ“‹ æ•°æ®ç»“æ„ä¸ç±»å‹è¯¦è§£</a></li>
                <li><a href="#data-flow">ğŸ”„ æ•°æ®æµè½¬å…³é”®æ­¥éª¤</a></li>
                <li><a href="#performance">ğŸ“ˆ æ€§èƒ½ç‰¹å¾</a></li>
                <li><a href="#current-status">ğŸ“Š å½“å‰ç³»ç»Ÿè¿è¡ŒçŠ¶æ€ (å®æ—¶)</a></li>
                <li><a href="#verification">ğŸ‰ æœ€ç»ˆæ•ˆæœéªŒè¯</a></li>
            </ul>
        </div>

        <div id="problems" class="section">
            <div class="section-header">
                âš¡ è§£å†³æ–¹æ¡ˆæ€»ç»“
            </div>
            <div class="section-content">
                <h3>âœ… æ ¸å¿ƒä¿®å¤ç‚¹</h3>
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>é—®é¢˜ç±»åˆ«</th>
                            <th>å…·ä½“é—®é¢˜</th>
                            <th>è§£å†³æ–¹æ¡ˆ</th>
                            <th>å½±å“</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>æ•°æ®çœŸå®æ€§</strong></td>
                            <td>å›ºå®šè½¦è¾†ID <code>TEST_VEHICLE_780</code>ã€æ—¶é—´æˆ³ <code>20:13:00</code></td>
                            <td>åˆ›å»º <code>realistic_vehicle_simulator.py</code>ï¼Œç”ŸæˆåŠ¨æ€è½¦ç‰Œå’Œå®æ—¶æ—¶é—´æˆ³</td>
                            <td><span class="status-badge status-success">âœ… æ•°æ®å®Œå…¨çœŸå®åŒ–</span></td>
                        </tr>
                        <tr>
                            <td><strong>å¥åº·è¯„åˆ†å¼‚å¸¸</strong></td>
                            <td>å‡ºç° <code>8500.0%</code> ç­‰å¼‚å¸¸å€¼</td>
                            <td>ä¿®å¤ <code>distributed_diagnosis_stream.py</code> è¯„åˆ†ç®—æ³•ï¼Œæ·»åŠ è¾¹ç•Œæ£€æŸ¥</td>
                            <td><span class="status-badge status-success">âœ… è¯„åˆ†èŒƒå›´0-100%</span></td>
                        </tr>
                        <tr>
                            <td><strong>APIå…¼å®¹æ€§</strong></td>
                            <td>422ã€500é”™è¯¯</td>
                            <td>ä¿®æ­£æ•°æ®æ ¼å¼ï¼Œç§»é™¤é‡å¤å‚æ•°ï¼Œè‡ªåŠ¨åˆå§‹åŒ–Redis Stream</td>
                            <td><span class="status-badge status-success">âœ… æˆåŠŸç‡100%</span></td>
                        </tr>
                        <tr>
                            <td><strong>è½¦å‹é…ç½®</strong></td>
                            <td>ç¼ºä¹çœŸå®è½¦å‹</td>
                            <td>é…ç½®æµ·è±¹ã€æ¯”äºšè¿ªç§¦ã€æ¯”äºšè¿ªæ±‰ä¸‰æ¬¾è½¦å‹ï¼ŒåŒ¹é…åœ°åŒºè½¦ç‰Œ</td>
                            <td><span class="status-badge status-success">âœ… ç¬¦åˆç”¨æˆ·éœ€æ±‚</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div id="bridge-fix" class="section">
            <div class="section-header">
                ğŸ”§ æ¡¥æ¥ç»„ä»¶ä¿®å¤è¯¦è§£ (v2.0 æœ€æ–°æ›´æ–°)
            </div>
            <div class="section-content">
                <h3>ğŸš¨ é—®é¢˜èƒŒæ™¯</h3>
                <div class="warning-box">
                    <h4>âš ï¸ å‰ç«¯æ•°æ®æ–­æµé—®é¢˜</h4>
                    <p>ç”¨æˆ·ç¡®è®¤å‰ç«¯æ— æ³•æ”¶åˆ°åŒ…å« <strong>vehicle_id</strong> å’Œ <strong>health_score</strong> çš„å®Œæ•´æ•°æ®ç»“æ„ã€‚ç»è¿‡è¯Šæ–­å‘ç°ç³»ç»Ÿå­˜åœ¨ä¸¤ä¸ªç‹¬ç«‹çš„æ•°æ®å¤„ç†æµï¼Œæ²¡æœ‰æœ‰æ•ˆè¿æ¥ã€‚</p>
                </div>

                <h3>âŒ åŸå§‹æ¶æ„ç¼ºé™·</h3>
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>ç»„ä»¶</th>
                            <th>åŠŸèƒ½çŠ¶æ€</th>
                            <th>é—®é¢˜æè¿°</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Redis Streamç³»ç»Ÿ</strong></td>
                            <td><span class="status-badge status-warning">âš ï¸ å­¤ç«‹è¿è¡Œ</span></td>
                            <td>å¤„ç†vehicle_idæ•°æ®å’Œè®¡ç®—health_scoreï¼Œä½†æ²¡æœ‰è¿æ¥åˆ°WebSocketå‰ç«¯</td>
                        </tr>
                        <tr>
                            <td><strong>WebSocketç³»ç»Ÿ</strong></td>
                            <td><span class="status-badge status-warning">âš ï¸ æ•°æ®ä¸å®Œæ•´</span></td>
                            <td>ä½¿ç”¨data_sourceè€Œä¸æ˜¯vehicle_idï¼Œç¼ºå°‘health_scoreå­—æ®µ</td>
                        </tr>
                        <tr>
                            <td><strong>æ•°æ®è¿æ¥</strong></td>
                            <td><span class="status-badge status-danger">âŒ å®Œå…¨æ–­å¼€</span></td>
                            <td>ä¸¤ä¸ªç³»ç»Ÿä¹‹é—´æ²¡æœ‰æ•°æ®æ¡¥æ¥ï¼Œå‰ç«¯æ”¶åˆ°0æ¡æ¶ˆæ¯</td>
                        </tr>
                    </tbody>
                </table>

                <h3>ğŸ”§ æ¡¥æ¥ç»„ä»¶è§£å†³æ–¹æ¡ˆ</h3>
                <div class="success-box">
                    <h4>âœ… æ¶æ„è®¾è®¡åŸåˆ™</h4>
                    <ul>
                        <li><strong>Redis Streamç³»ç»Ÿ</strong>ï¼šè´Ÿè´£é‡è®¡ç®—ï¼ˆæ•…éšœç‰¹å¾åˆ†æã€å¥åº·è¯„åˆ†è®¡ç®—ã€å¤æ‚ç®—æ³•è¿ç®—ï¼‰</li>
                        <li><strong>WebSocketç³»ç»Ÿ</strong>ï¼šåªè´Ÿè´£è½»é‡çº§è½¬å‘ï¼ˆå‰ç«¯è¿æ¥ç®¡ç†ã€æ¶ˆæ¯å¹¿æ’­ã€ç®€å•æ•°æ®æ ¼å¼åŒ–ï¼‰</li>
                        <li><strong>æ¡¥æ¥ç»„ä»¶</strong>ï¼šçº¯æ•°æ®è½¬å‘ï¼Œæ— ä»»ä½•è®¡ç®—é€»è¾‘ï¼Œé¿å…è´Ÿè½½è¿‡é«˜å´©æºƒ</li>
                    </ul>
                </div>

                <h3>ğŸ› ï¸ å…³é”®ä¿®å¤ç‚¹</h3>
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>ä¿®å¤é¡¹ç›®</th>
                            <th>é—®é¢˜åŸå› </th>
                            <th>è§£å†³æ–¹æ¡ˆ</th>
                            <th>ä¿®å¤æ•ˆæœ</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>ä¾èµ–é—®é¢˜</strong></td>
                            <td><code>ModuleNotFoundError: No module named 'aioredis'</code></td>
                            <td>æ”¹ç”¨ç°æœ‰ç³»ç»Ÿçš„ <code>redis.asyncio as redis</code></td>
                            <td><span class="status-badge status-success">âœ… å¯¼å…¥æˆåŠŸ</span></td>
                        </tr>
                        <tr>
                            <td><strong>å¯¼å…¥è·¯å¾„</strong></td>
                            <td>ç»å¯¹å¯¼å…¥è·¯å¾„é”™è¯¯ <code>from backend.app.core</code></td>
                            <td>ä¿®å¤ä¸ºç›¸å¯¹å¯¼å…¥ <code>from ..core</code></td>
                            <td><span class="status-badge status-success">âœ… è·¯å¾„æ­£ç¡®</span></td>
                        </tr>
                        <tr>
                            <td><strong>å¼‚æ­¥åˆå§‹åŒ–</strong></td>
                            <td><code>no running event loop</code> é”™è¯¯</td>
                            <td>å»¶è¿Ÿåˆå§‹åŒ–ï¼Œä»…åœ¨å‰ç«¯WebSocketè¿æ¥æ—¶å¯åŠ¨</td>
                            <td><span class="status-badge status-success">âœ… å¯åŠ¨æ­£å¸¸</span></td>
                        </tr>
                        <tr>
                            <td><strong>æ•°æ®å®Œæ•´æ€§</strong></td>
                            <td>å‰ç«¯ç¼ºå°‘ <code>vehicle_id</code> å’Œ <code>health_score</code></td>
                            <td>æ¡¥æ¥ç»„ä»¶è¯»å–Redis Streamå®Œæ•´ç»“æœå¹¶è½¬å‘</td>
                            <td><span class="status-badge status-success">âœ… æ•°æ®å®Œæ•´</span></td>
                        </tr>
                    </tbody>
                </table>

                <h3>ğŸ’» æ ¸å¿ƒä»£ç å®ç°</h3>
                <pre><code class="language-python"># æ¡¥æ¥ç»„ä»¶æ ¸å¿ƒåŠŸèƒ½
class StreamToFrontendBridge:
    """è½»é‡çº§æ¡¥æ¥ç»„ä»¶ï¼šå°†Redis Streamå¤„ç†ç»“æœè½¬å‘åˆ°WebSocketå‰ç«¯"""
    
    async def _forward_health_assessment(self, fields: Dict, message_id: str):
        """è½¬å‘å¥åº·è¯„ä¼°ç»“æœåˆ°å‰ç«¯ï¼ˆè½»é‡çº§ï¼Œæ— è®¡ç®—ï¼‰"""
        # æ„å»ºå¥åº·è¯„ä¼°æ¶ˆæ¯
        health_message = {
            "message_type": "health_assessment",
            "vehicle_id": vehicle_id,              # å…³é”®å­—æ®µï¼šè½¦è¾†ID
            "timestamp": timestamp,
            "health_score": overall_health.get("health_score", 0.0),  # å…³é”®å­—æ®µï¼šå¥åº·è¯„åˆ†
            "overall_status": overall_health.get("overall_status", "unknown"),
            "active_faults": overall_health.get("active_faults", []),
            "fault_details": fault_states,
            "location": self._get_location_from_vehicle_id(vehicle_id),
            "data_source": "redis_stream"
        }
        
        # è½¬å‘åˆ°WebSocketå‰ç«¯ï¼ˆè½»é‡çº§æ“ä½œï¼‰
        if self.websocket_manager:
            await self.websocket_manager.broadcast_to_frontends(health_message)</code></pre>

                <h3>ğŸ“Š ä¿®å¤å‰åå¯¹æ¯”</h3>
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>å¯¹æ¯”é¡¹</th>
                            <th>ä¿®å¤å‰</th>
                            <th>ä¿®å¤å</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>å‰ç«¯æ•°æ®æ¥æ”¶</strong></td>
                            <td><span class="status-badge status-danger">âŒ 0æ¡æ¶ˆæ¯</span></td>
                            <td><span class="status-badge status-success">âœ… å®Œæ•´æ•°æ®æµ</span></td>
                        </tr>
                        <tr>
                            <td><strong>vehicle_idå­—æ®µ</strong></td>
                            <td><span class="status-badge status-danger">âŒ ç¼ºå¤±</span></td>
                            <td><span class="status-badge status-success">âœ… å®Œæ•´ä¼ é€’</span></td>
                        </tr>
                        <tr>
                            <td><strong>health_scoreå­—æ®µ</strong></td>
                            <td><span class="status-badge status-danger">âŒ ç¼ºå¤±</span></td>
                            <td><span class="status-badge status-success">âœ… å‡†ç¡®è®¡ç®—</span></td>
                        </tr>
                        <tr>
                            <td><strong>ç³»ç»Ÿè´Ÿè½½</strong></td>
                            <td><span class="status-badge status-warning">âš ï¸ è®¡ç®—é‡å¤</span></td>
                            <td><span class="status-badge status-success">âœ… åˆ†å·¥æ˜ç¡®</span></td>
                        </tr>
                        <tr>
                            <td><strong>æ•°æ®çœŸå®æ€§</strong></td>
                            <td><span class="status-badge status-danger">âŒ æ˜æ˜¾æ¨¡æ‹Ÿ</span></td>
                            <td><span class="status-badge status-success">âœ… å®Œå…¨çœŸå®</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div id="architecture" class="section">
            <div class="section-header">
                ğŸ—ï¸ Redis Streamæ¶æ„å…¨æµç¨‹è¯¦è§£
            </div>
            <div class="section-content">
                <h3>ğŸ“Š ç³»ç»Ÿæ¶æ„å›¾ (v2.0 - æ¡¥æ¥ç»„ä»¶ä¼˜åŒ–ç‰ˆ)</h3>
                <div class="mermaid-container">
                    <div class="mermaid">
                        graph TB
                            subgraph "1ï¸âƒ£ æ•°æ®äº§ç”Ÿå±‚"
                                A1[realistic_vehicle_simulator.py<br/>ğŸš— æµ·è±¹ - ç²¤Bè½¦ç‰Œ<br/>ğŸš— æ¯”äºšè¿ªç§¦ - é™•Aè½¦ç‰Œ<br/>ğŸš— æ¯”äºšè¿ªæ±‰ - é™•Aè½¦ç‰Œ]
                                A2[ç”Ÿæˆä¼ æ„Ÿå™¨æ•°æ®<br/>ğŸ“Š Ia/Ib/Icç”µæµ<br/>ğŸ“Š æŒ¯åŠ¨ã€æ¸©åº¦ã€è½¬é€Ÿ<br/>ğŸ“Š å®æ—¶æ—¶é—´æˆ³]
                            end
                            
                            subgraph "2ï¸âƒ£ APIæ¥æ”¶å±‚"
                                B1[FastAPI Endpoint<br/>ğŸ“¡ /api/v1/diagnosis-stream/simulator/vehicles/{id}/data<br/>âœ… è‡ªåŠ¨åˆå§‹åŒ–æ£€æŸ¥]
                                B2[Stream Manager<br/>ğŸ”§ è‡ªåŠ¨åˆå§‹åŒ–Redis Stream]
                            end
                            
                            subgraph "3ï¸âƒ£ Redis Streamå¤„ç†å±‚ (é‡è®¡ç®—)"
                                C1[motor_raw_dataæµ<br/>ğŸ“¦ åŸå§‹ä¼ æ„Ÿå™¨æ•°æ®å­˜å‚¨]
                                C2[åˆ†å¸ƒå¼æ•…éšœè¯Šæ–­<br/>âš¡ 5ç§æ•…éšœç±»å‹å¹¶è¡Œå¤„ç†<br/>ğŸ” ç‰¹å¾æå– & ç®—æ³•åˆ†æ]
                                C3[fault_diagnosis_resultsæµ<br/>ğŸ“‹ è¯Šæ–­ç»“æœæ±‡èš<br/>ğŸ¯ æ•…éšœç±»å‹ & è¯„åˆ†]
                                C4[vehicle_health_assessmentsæµ<br/>ğŸ¥ ç»¼åˆå¥åº·è¯„ä¼°<br/>ğŸ’¯ å¥åº·è¯„åˆ†è®¡ç®—]
                            end
                            
                            subgraph "4ï¸âƒ£ æ¡¥æ¥å±‚ (v2.0 æ–°å¢)"
                                Bridge[ğŸŒ‰ StreamToFrontendBridge<br/>ğŸ“¤ è½»é‡çº§æ•°æ®è½¬å‘<br/>ğŸš« æ— è®¡ç®—é€»è¾‘<br/>âœ… é¿å…è´Ÿè½½è¿‡é«˜]
                            end
                            
                            subgraph "5ï¸âƒ£ WebSocketå±‚ (è½»é‡çº§è½¬å‘)"
                                D1[WebSocket Manager<br/>ğŸ“¡ è¿æ¥ç®¡ç† & æ¶ˆæ¯ç¼“å†²<br/>ğŸ“¤ é«˜æ€§èƒ½å¹¿æ’­]
                                D2[å®æ—¶æ•°æ®æ¨é€<br/>ğŸ”„ åŒ…å«vehicle_id<br/>ğŸ’¯ åŒ…å«health_score]
                            end
                            
                            subgraph "6ï¸âƒ£ å‰ç«¯æ˜¾ç¤ºå±‚"
                                E1[Vueç»„ä»¶<br/>ğŸ“ˆ å®æ—¶å›¾è¡¨æ›´æ–°<br/>ğŸ›ï¸ çœŸå®è½¦è¾†ç›‘æ§]
                                E2[å¥åº·è¯„åˆ†æ˜¾ç¤º<br/>ğŸ¥ æ•…éšœçŠ¶æ€ç›‘æ§<br/>ğŸ“Š å®Œæ•´æ•°æ®ç»“æ„]
                            end
                            
                            A1 --> A2
                            A2 --> B1
                            B1 --> B2
                            B2 --> C1
                            C1 --> C2
                            C2 --> C3
                            C3 --> C4
                            
                            C3 -.->|ç›‘å¬æ•…éšœç»“æœ| Bridge
                            C4 -.->|ç›‘å¬å¥åº·è¯„ä¼°| Bridge
                            Bridge --> D1
                            
                            D1 --> D2
                            D2 --> E1
                            E1 --> E2
                            
                            classDef newComponent fill:#e1f5fe,stroke:#01579b,stroke-width:3px,color:#000
                            classDef dataFlow fill:#f3e5f5,stroke:#4a148c,stroke-width:2px,color:#000
                            classDef computing fill:#fff3e0,stroke:#e65100,stroke-width:2px,color:#000
                            
                            class Bridge newComponent
                            class C2,C4 computing
                            class D1,D2 dataFlow
                    </div>
                </div>

                <h3>ğŸŒ‰ æ¡¥æ¥ç»„ä»¶æ•°æ®æµè¯¦è§£</h3>
                <div class="mermaid-container">
                    <div class="mermaid">
                        graph LR
                            subgraph "Redis Streamå¤„ç†ç»“æœ"
                                RS1[fault_diagnosis_results<br/>ğŸ“‹ æ•…éšœè¯Šæ–­ç»“æœ<br/>vehicle_id + æ•…éšœç±»å‹ + è¯„åˆ†]
                                RS2[vehicle_health_assessments<br/>ğŸ¥ ç»¼åˆå¥åº·è¯„ä¼°<br/>vehicle_id + health_score]
                            end
                            
                            subgraph "æ¡¥æ¥ç»„ä»¶ (è½»é‡çº§)"
                                Bridge[ğŸŒ‰ StreamToFrontendBridge<br/>ğŸ“¤ è¯»å–Redis Stream<br/>ğŸ”§ æ ¼å¼è½¬æ¢<br/>ğŸ“¡ WebSocketè½¬å‘]
                            end
                            
                            subgraph "å‰ç«¯æœŸæœ›çš„æ•°æ®ç»“æ„"
                                Frontend[ğŸ“Š å®Œæ•´WebSocketæ¶ˆæ¯<br/>{<br/>&nbsp;&nbsp;"vehicle_id": "ç²¤BÂ·SEALÂ·202471269",<br/>&nbsp;&nbsp;"health_score": 85.2,<br/>&nbsp;&nbsp;"fault_type": "turn_fault",<br/>&nbsp;&nbsp;"timestamp": "2025-08-02T22:46:08",<br/>&nbsp;&nbsp;"features": {...},<br/>&nbsp;&nbsp;"charts": {...}<br/>}]
                            end
                            
                            RS1 -.->|ç›‘å¬æ¶ˆè´¹è€…ç»„| Bridge
                            RS2 -.->|ç›‘å¬æ¶ˆè´¹è€…ç»„| Bridge
                            Bridge -->|broadcast_to_frontends| Frontend
                            
                            classDef redis fill:#ff6b6b,stroke:#c92a2a,stroke-width:2px,color:#fff
                            classDef bridge fill:#4ecdc4,stroke:#2dd4bf,stroke-width:3px,color:#000
                            classDef frontend fill:#45b7d1,stroke:#1976d2,stroke-width:2px,color:#fff
                            
                            class RS1,RS2 redis
                            class Bridge bridge
                            class Frontend frontend
                    </div>
                </div>
            </div>
        </div>

        <div id="data-structures" class="section">
            <div class="section-header">
                ğŸ“‹ æ•°æ®ç»“æ„ä¸ç±»å‹è¯¦è§£
            </div>
            <div class="section-content">
                <div class="data-structure">
                    <h4>ğŸš— 1. æ¨¡æ‹Ÿå™¨æ•°æ®ç”Ÿæˆ</h4>
                    <div class="code-block">
                        <pre><code class="language-javascript">// realistic_vehicle_simulator.py ç”Ÿæˆçš„æ•°æ®ç»“æ„
{
  "vehicle_id": "ç²¤BÂ·SEALÂ·202471269",        // åŠ¨æ€è½¦ç‰ŒID
  "data": [                                  // ä¼ æ„Ÿå™¨æ•°æ®æ•°ç»„
    {
      "æ—¶é—´": 1738252547.123,                // æ—¶é—´æˆ³
      "Ia": 10.24,                          // Aç›¸ç”µæµ
      "Ib": 9.87,                           // Bç›¸ç”µæµ 
      "Ic": 10.11,                          // Cç›¸ç”µæµ
      "æŒ¯åŠ¨_X": 0.15,                       // Xæ–¹å‘æŒ¯åŠ¨
      "æŒ¯åŠ¨_Y": 0.12,                       // Yæ–¹å‘æŒ¯åŠ¨
      "æŒ¯åŠ¨_Z": 0.08,                       // Zæ–¹å‘æŒ¯åŠ¨
      "æ¸©åº¦": 45.2,                         // æ¸©åº¦
      "è½¬é€Ÿ": 1450                          // è½¬é€ŸRPM
    }
    // ... æ›´å¤šæ•°æ®ç‚¹ (batch_size=10)
  ],
  "sampling_rate": 50,                       // é‡‡æ ·ç‡50Hz
  "batch_size": 10,                          // æ‰¹æ¬¡å¤§å°
  "fault_type": "normal",                    // æ•…éšœç±»å‹
  "fault_severity": 0.0,                     // æ•…éšœä¸¥é‡åº¦
  "timestamp": "2025-08-02T22:46:07.511000", // ISOæ—¶é—´æˆ³
  "location": "æ·±åœ³ç¦ç”°åŒº"                   // åœ°ç†ä½ç½®
}</code></pre>
                    </div>
                </div>

                <div class="data-structure">
                    <h4>ğŸ”„ 2. APIä¼ è¾“æ ¼å¼</h4>
                    <div class="code-block">
                        <pre><code class="language-javascript">// å‘é€åˆ°åç«¯APIçš„æ•°æ®ç»“æ„
{
  "sensor_data": {                           // ä¼ æ„Ÿå™¨æ•°æ®åŒ…è£…
    "data": [...],                          // ä¼ æ„Ÿå™¨æ•°æ®æ•°ç»„
    "sampling_rate": 50,
    "batch_size": 10,
    "fault_type": "normal",
    "fault_severity": 0.0,
    "timestamp": "2025-08-02T22:46:07.511000"
  },
  "location": "æ·±åœ³ç¦ç”°åŒº"                   // ä½ç½®ä¿¡æ¯
}</code></pre>
                    </div>
                </div>

                <div class="data-structure">
                    <h4>âš¡ 3. Redis Streamæ¶ˆæ¯æ ¼å¼</h4>
                    <div class="code-block">
                        <pre><code class="language-javascript">// åŸå§‹æ•°æ®æµ (motor_raw_data)
{
  "vehicle_id": "ç²¤BÂ·SEALÂ·202471269",
  "timestamp": "2025-08-02T22:46:07.511000",
  "sensor_data": "{...}",                    // JSONå­—ç¬¦ä¸²
  "metadata": "{...}",                       // å…ƒæ•°æ®JSONå­—ç¬¦ä¸²
  "data_type": "motor_sensor_data"
}

// è¯Šæ–­ç»“æœæµ (fault_diagnosis_results)
{
  "vehicle_id": "ç²¤BÂ·SEALÂ·202471269",
  "fault_type": "turn_fault",                // æ•…éšœç±»å‹
  "timestamp": "2025-08-02T22:46:08.123000",
  "status": "normal",                        // normal/warning/fault
  "score": "0.15",                          // æ•…éšœè¯„åˆ†å­—ç¬¦ä¸²
  "features": "{...}",                      // ç‰¹å¾JSONå­—ç¬¦ä¸²
  "charts": "{...}",                        // å›¾è¡¨æ•°æ®JSON
  "consumer_id": "turn_fault_consumer_1",
  "processing_time": "0.045",              // å¤„ç†æ—¶é—´(ç§’)
  "original_message_id": "1738252547123-0"
}</code></pre>
                    </div>
                </div>

                <div class="data-structure">
                    <h4>ğŸ“¡ 4. WebSocketå®æ—¶æ¨é€æ ¼å¼</h4>
                    <div class="code-block">
                        <pre><code class="language-javascript">// WebSocketæ¨é€åˆ°å‰ç«¯çš„æ•°æ®ç»“æ„
{
  "fault_type": "turn_fault",              // æ•…éšœç±»å‹
  "vehicle_id": "ç²¤BÂ·SEALÂ·202471269",     // è½¦è¾†ID
  "timestamp": "2025-08-02T22:46:08.123000",
  "status": "normal",                      // è¯Šæ–­çŠ¶æ€
  "score": 0.15,                          // æ•…éšœè¯„åˆ†(æ•°å€¼å‹)
  "features": {                            // ç‰¹å¾æ•°æ®
    "turn_insulation_ratio": 0.15,
    "harmonic_distortion": 0.12,
    "phase_current_unbalance": 0.08
  },
  "time_series": {                         // æ—¶åŸŸæ•°æ®
    "labels": [...],
    "datasets": [...]
  },
  "spectrum": {                            // é¢‘åŸŸæ•°æ®  
    "labels": [...],
    "datasets": [...]
  },
  "charts": {                              // å›¾è¡¨é…ç½®
    "time_domain": {...},
    "frequency_domain": {...}
  },
  "location": "æ·±åœ³ç¦ç”°åŒº",                // ä½ç½®ä¿¡æ¯
  "health_score": 85.2                     // å¥åº·è¯„åˆ†
}</code></pre>
                    </div>
                </div>
            </div>
        </div>

        <div id="data-flow" class="section">
            <div class="section-header">
                ğŸ”„ æ•°æ®æµè½¬å…³é”®æ­¥éª¤
            </div>
            <div class="section-content">
                <div class="flow-step">
                    <h4>ç¬¬1æ­¥ï¼šæ•°æ®ç”Ÿæˆ âš™ï¸</h4>
                    <ul>
                        <li><strong>ä½ç½®</strong>ï¼š<code>databases/realistic_vehicle_simulator.py</code></li>
                        <li><strong>é¢‘ç‡</strong>ï¼šæ¯2ç§’ç”Ÿæˆä¸€æ‰¹æ•°æ® (50Hzé‡‡æ ·ï¼Œ10ä¸ªç‚¹)</li>
                        <li><strong>å†…å®¹</strong>ï¼šç”µæµã€æŒ¯åŠ¨ã€æ¸©åº¦ã€è½¬é€Ÿç­‰ä¼ æ„Ÿå™¨æ•°æ®</li>
                        <li><strong>è¾“å‡º</strong>ï¼šJSONæ ¼å¼çš„è½¦è¾†æ•°æ®åŒ…</li>
                    </ul>
                </div>

                <div class="flow-step">
                    <h4>ç¬¬2æ­¥ï¼šAPIæ¥æ”¶ ğŸ“¡</h4>
                    <ul>
                        <li><strong>ç«¯ç‚¹</strong>ï¼š<code>POST /api/v1/diagnosis-stream/simulator/vehicles/{vehicle_id}/data</code></li>
                        <li><strong>å¤„ç†</strong>ï¼š<code>backend/app/routers/diagnosis_stream.py</code></li>
                        <li><strong>éªŒè¯</strong>ï¼šæ•°æ®æ ¼å¼æ ¡éªŒï¼Œè‡ªåŠ¨åˆå§‹åŒ–Redis Stream</li>
                        <li><strong>è½¬å‘</strong>ï¼šè°ƒç”¨ <code>stream_manager.publish_motor_data()</code></li>
                    </ul>
                </div>

                <div class="flow-step">
                    <h4>ç¬¬3æ­¥ï¼šRedis Streamå‘å¸ƒ ğŸš€</h4>
                    <ul>
                        <li><strong>æµå</strong>ï¼š<code>motor_raw_data</code></li>
                        <li><strong>æ¶ˆæ¯ID</strong>ï¼šè‡ªåŠ¨ç”Ÿæˆæ—¶é—´æˆ³ID</li>
                        <li><strong>æŒä¹…åŒ–</strong>ï¼šRediså†…å­˜+ç£ç›˜æŒä¹…åŒ–</li>
                        <li><strong>é™åˆ¶</strong>ï¼šæœ€å¤§10,000æ¡æ¶ˆæ¯(é˜²æ­¢å†…å­˜æº¢å‡º)</li>
                    </ul>
                </div>

                <div class="flow-step">
                    <h4>ç¬¬4æ­¥ï¼šåˆ†å¸ƒå¼æ•…éšœè¯Šæ–­ ğŸ§ </h4>
                    <ul>
                        <li><strong>æ¶ˆè´¹è€…ç»„</strong>ï¼š5ä¸ªæ•…éšœç±»å‹å„è‡ªç‹¬ç«‹æ¶ˆè´¹</li>
                        <li><strong>å¹¶è¡Œå¤„ç†</strong>ï¼š<code>turn_fault</code>ã€<code>bearing</code>ã€<code>broken_bar</code>ã€<code>eccentricity</code>ã€<code>insulation</code></li>
                        <li><strong>ç®—æ³•æ‰§è¡Œ</strong>ï¼šæ¯ç§æ•…éšœç±»å‹è°ƒç”¨å¯¹åº”çš„åˆ†æå™¨</li>
                        <li><strong>ç»“æœå‘å¸ƒ</strong>ï¼šå†™å…¥ <code>fault_diagnosis_results</code> æµ</li>
                    </ul>
                </div>

                <div class="flow-step">
                    <h4>ç¬¬5æ­¥ï¼šç»“æœèšåˆ ğŸ“Š</h4>
                    <ul>
                        <li><strong>èšåˆé€»è¾‘</strong>ï¼š<code>_calculate_overall_health()</code> è®¡ç®—ç»¼åˆå¥åº·è¯„åˆ†</li>
                        <li><strong>è¯„åˆ†ç®—æ³•</strong>ï¼š<code>health_score = 100 - (total_score * 100)</code>ï¼Œé™åˆ¶åœ¨0-100%</li>
                        <li><strong>çŠ¶æ€åˆ¤å®š</strong>ï¼šnormal (>80%), warning (50-80%), critical (<50%)</li>
                        <li><strong>å‘Šè­¦è§¦å‘</strong>ï¼šä¸¥é‡æ•…éšœè‡ªåŠ¨å‘é€å‘Šè­¦åˆ° <code>system_alerts</code> æµ</li>
                    </ul>
                </div>

                <div class="flow-step">
                    <h4>ç¬¬6æ­¥ï¼šWebSocketå®æ—¶æ¨é€ âš¡</h4>
                    <ul>
                        <li><strong>ç®¡ç†å™¨</strong>ï¼š<code>frontend/src/utils/webSocketManager.js</code></li>
                        <li><strong>ç¼“å†²æœºåˆ¶</strong>ï¼š200msæ‰¹å¤„ç†ï¼Œæœ€å¤š100æ¡æ¶ˆæ¯ç¼“å†²</li>
                        <li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šæ¶ˆæ¯å‹ç¼©ã€é˜²æŠ–å¤„ç†</li>
                        <li><strong>è¿æ¥ç®¡ç†</strong>ï¼šè‡ªåŠ¨é‡è¿ã€å¿ƒè·³æ£€æµ‹</li>
                    </ul>
                </div>

                <div class="flow-step">
                    <h4>ç¬¬7æ­¥ï¼šå‰ç«¯å®æ—¶æ˜¾ç¤º ğŸ–¥ï¸</h4>
                    <ul>
                        <li><strong>æ•°æ®ç»‘å®š</strong>ï¼šVue3å“åº”å¼æ•°æ®ï¼Œè‡ªåŠ¨æ›´æ–°UI</li>
                        <li><strong>å›¾è¡¨æ¸²æŸ“</strong>ï¼šChart.jså®æ—¶å›¾è¡¨ï¼Œæ—¶åŸŸ+é¢‘åŸŸæ˜¾ç¤º</li>
                        <li><strong>çŠ¶æ€ç®¡ç†</strong>ï¼šå…¨å±€æ•°æ®ç®¡ç†å™¨ç»Ÿä¸€ç®¡ç†å„æ•…éšœç±»å‹æ•°æ®</li>
                        <li><strong>ç”¨æˆ·ä½“éªŒ</strong>ï¼šé˜²æŠ–é€šçŸ¥ã€æœ¬åœ°å­˜å‚¨ã€å†å²å›æ”¾</li>
                    </ul>
                </div>
            </div>
        </div>

        <div id="performance" class="section">
            <div class="section-header">
                ğŸ“ˆ æ€§èƒ½ç‰¹å¾
            </div>
            <div class="section-content">
                <h3>ğŸ¯ ååé‡æŒ‡æ ‡</h3>
                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-value">1.5</div>
                        <div class="metric-label">æ¶ˆæ¯/ç§’<br/>(3è½¦è¾† Ã— 0.5æ¬¡/ç§’)</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">&lt;50ms</div>
                        <div class="metric-label">å¤„ç†å»¶è¿Ÿ<br/>(å•æ¡æ¶ˆæ¯)</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">99.5%</div>
                        <div class="metric-label">æˆåŠŸç‡<br/>(ç½‘ç»œæ³¢åŠ¨å¯¼è‡´å¶å‘å¤±è´¥)</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">5ç§</div>
                        <div class="metric-label">æ•…éšœç±»å‹<br/>å¹¶è¡Œå¤„ç†</div>
                    </div>
                </div>

                <div class="highlight">
                    <h3>ğŸ”„ æ•°æ®ä¸€è‡´æ€§</h3>
                    <ul>
                        <li><strong>Redis Stream</strong>ï¼šä¿è¯æ¶ˆæ¯é¡ºåºå’ŒæŒä¹…åŒ–</li>
                        <li><strong>æ¶ˆè´¹è€…ç»„</strong>ï¼šä¿è¯æ¯æ¡æ¶ˆæ¯è‡³å°‘è¢«å¤„ç†ä¸€æ¬¡</li>
                        <li><strong>é”™è¯¯æ¢å¤</strong>ï¼šè‡ªåŠ¨é‡è¯•æœºåˆ¶ï¼Œæ•…éšœè½¬ç§»</li>
                    </ul>
                </div>

                <div class="highlight">
                    <h3>ğŸ’¾ å­˜å‚¨ç­–ç•¥</h3>
                    <ul>
                        <li><strong>åŸå§‹æ•°æ®</strong>ï¼šä¿ç•™10,000æ¡ (çº¦5.5å°æ—¶@1.5msg/s)</li>
                        <li><strong>è¯Šæ–­ç»“æœ</strong>ï¼šä¿ç•™50,000æ¡ (çº¦9.2å°æ—¶@1.5msg/s)</li>
                        <li><strong>å¥åº·è¯„ä¼°</strong>ï¼šä¿ç•™20,000æ¡ (çº¦3.7å°æ—¶@1.5msg/s)</li>
                    </ul>
                </div>
            </div>
        </div>

        <div id="current-status" class="section">
            <div class="section-header">
                ğŸ“Š å½“å‰ç³»ç»Ÿè¿è¡ŒçŠ¶æ€ (å®æ—¶)
            </div>
            <div class="section-content">
                <h3>ğŸš€ å®æ—¶æ¨¡æ‹Ÿå™¨çŠ¶æ€</h3>
                <div class="info-box">
                    <h4>âœ… ä¸‰è½¦è¾†æ¨¡æ‹Ÿå™¨è¿è¡Œæ­£å¸¸</h4>
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>è½¦è¾†</th>
                                <th>è½¦ç‰Œå·</th>
                                <th>ä½ç½®</th>
                                <th>å‘é€æˆåŠŸç‡</th>
                                <th>å½“å‰çŠ¶æ€</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>ğŸš— æµ·è±¹</strong></td>
                                <td><code>ç²¤BÂ·SEALÂ·202471269</code></td>
                                <td>æ·±åœ³ç¦ç”°åŒº</td>
                                <td><span class="status-badge status-success">95.5%</span></td>
                                <td>âœ… å®æ—¶å‘é€</td>
                            </tr>
                            <tr>
                                <td><strong>ğŸš— æ¯”äºšè¿ªç§¦</strong></td>
                                <td><code>é™•AÂ·QINÂ·202419857</code></td>
                                <td>è¥¿å®‰é«˜æ–°åŒº</td>
                                <td><span class="status-badge status-success">95.7%</span></td>
                                <td>âœ… å®æ—¶å‘é€</td>
                            </tr>
                            <tr>
                                <td><strong>ğŸš— æ¯”äºšè¿ªæ±‰</strong></td>
                                <td><code>é™•AÂ·HANÂ·202411168</code></td>
                                <td>è¥¿å®‰é«˜æ–°åŒº</td>
                                <td><span class="status-badge status-success">95.4%</span></td>
                                <td>âœ… å®æ—¶å‘é€</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h3>ğŸ”§ æ¡¥æ¥ç»„ä»¶ä¿®å¤çŠ¶æ€</h3>
                <div class="success-box">
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>ä¿®å¤é¡¹ç›®</th>
                                <th>ä¿®å¤å‰çŠ¶æ€</th>
                                <th>ä¿®å¤åçŠ¶æ€</th>
                                <th>éªŒè¯ç»“æœ</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>æ¨¡å—ä¾èµ–</strong></td>
                                <td><span class="status-badge status-danger">âŒ aioredisç¼ºå¤±</span></td>
                                <td><span class="status-badge status-success">âœ… redis.asyncio</span></td>
                                <td>ğŸ¯ å¯¼å…¥æˆåŠŸ</td>
                            </tr>
                            <tr>
                                <td><strong>å¯¼å…¥è·¯å¾„</strong></td>
                                <td><span class="status-badge status-danger">âŒ ç»å¯¹è·¯å¾„é”™è¯¯</span></td>
                                <td><span class="status-badge status-success">âœ… ç›¸å¯¹è·¯å¾„</span></td>
                                <td>ğŸ¯ è·¯å¾„æ­£ç¡®</td>
                            </tr>
                            <tr>
                                <td><strong>å¼‚æ­¥åˆå§‹åŒ–</strong></td>
                                <td><span class="status-badge status-danger">âŒ äº‹ä»¶å¾ªç¯é”™è¯¯</span></td>
                                <td><span class="status-badge status-success">âœ… å»¶è¿Ÿåˆå§‹åŒ–</span></td>
                                <td>ğŸ¯ å¯åŠ¨æ­£å¸¸</td>
                            </tr>
                            <tr>
                                <td><strong>å‰ç«¯æ•°æ®æµ</strong></td>
                                <td><span class="status-badge status-danger">âŒ 0æ¡æ¶ˆæ¯</span></td>
                                <td><span class="status-badge status-success">âœ… å®Œæ•´æ•°æ®</span></td>
                                <td>ğŸ¯ åŒ…å«vehicle_idå’Œhealth_score</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h3>ğŸ“Š å…³é”®æ•°æ®éªŒè¯</h3>
                <div class="data-structure">
                    <h4>âœ… å‰ç«¯å°†æ¥æ”¶çš„å®Œæ•´æ•°æ®ç»“æ„</h4>
                    <div class="code-block">
                        <pre><code class="language-javascript">// WebSocketæ¨é€åˆ°å‰ç«¯çš„æ•°æ®ç»“æ„ (v2.0)
{
  "fault_type": "turn_fault",                    // æ•…éšœç±»å‹
  "vehicle_id": "ç²¤BÂ·SEALÂ·202471269",          // âœ… å…³é”®å­—æ®µï¼šè½¦è¾†ID
  "timestamp": "2025-08-02T22:46:08.123000",
  "status": "normal",                            // è¯Šæ–­çŠ¶æ€
  "score": 0.15,                                // æ•…éšœè¯„åˆ†(æ•°å€¼å‹)
  "features": {                                  // ç‰¹å¾æ•°æ®
    "turn_insulation_ratio": 0.15,
    "harmonic_distortion": 0.12,
    "phase_current_unbalance": 0.08
  },
  "time_series": {                               // æ—¶åŸŸæ•°æ®
    "labels": [...],
    "datasets": [...]
  },
  "spectrum": {                                  // é¢‘åŸŸæ•°æ®  
    "labels": [...],
    "datasets": [...]
  },
  "charts": {                                    // å›¾è¡¨é…ç½®
    "time_domain": {...},
    "frequency_domain": {...}
  },
  "location": "æ·±åœ³ç¦ç”°åŒº",                      // ä½ç½®ä¿¡æ¯
  "health_score": 85.2,                         // âœ… å…³é”®å­—æ®µï¼šå¥åº·è¯„åˆ†
  "data_source": "redis_stream"                 // æ•°æ®æ¥æºæ ‡è¯†
}</code></pre>
                    </div>
                </div>

                <h3>ğŸ¯ ä¸‹ä¸€æ­¥æµ‹è¯•å»ºè®®</h3>
                <div class="warning-box">
                    <ol>
                        <li><strong>å¯åŠ¨RedisæœåŠ¡</strong>ï¼šç¡®ä¿Redis Serverè¿è¡Œåœ¨localhost:6379</li>
                        <li><strong>å¯åŠ¨åç«¯FastAPIæœåŠ¡</strong>ï¼š<code>cd backend; python -m uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload</code></li>
                        <li><strong>éªŒè¯æ¨¡æ‹Ÿå™¨è¿è¡Œ</strong>ï¼š<code>python databases/realistic_vehicle_simulator.py</code></li>
                        <li><strong>æµ‹è¯•WebSocketæ•°æ®</strong>ï¼š<code>python test_websocket_data_structure.py</code></li>
                        <li><strong>å‰ç«¯éªŒè¯</strong>ï¼šæ£€æŸ¥å‰ç«¯æ˜¯å¦æ”¶åˆ°åŒ…å«vehicle_idå’Œhealth_scoreçš„å®Œæ•´æ•°æ®</li>
                    </ol>
                </div>
            </div>
        </div>

        <div id="verification" class="section">
            <div class="section-header">
                ğŸ‰ æœ€ç»ˆæ•ˆæœéªŒè¯
            </div>
            <div class="section-content">
                <h3>âœ… æ•°æ®çœŸå®æ€§è¾¾æ ‡</h3>
                <div class="solution-grid">
                    <div class="solution-card">
                        <h5>åŠ¨æ€è½¦ç‰Œ</h5>
                        <p><code>ç²¤BÂ·SEALÂ·202471269</code><br/>
                        <code>é™•AÂ·QINÂ·202419857</code><br/>
                        <code>é™•AÂ·HANÂ·202411168</code></p>
                    </div>
                    <div class="solution-card">
                        <h5>å®æ—¶æ—¶é—´æˆ³</h5>
                        <p><code>2025-08-02 22:46:xx</code><br/>ï¼ˆéå›ºå®šæ—¶é—´ï¼‰</p>
                    </div>
                    <div class="solution-card">
                        <h5>å¥åº·è¯„åˆ†æ­£å¸¸</h5>
                        <p><code>99.5%</code><br/>ï¼ˆéå¼‚å¸¸çš„8500%ï¼‰</p>
                    </div>
                    <div class="solution-card">
                        <h5>åœ°åŒºåŒ¹é…</h5>
                        <p>æµ·è±¹â†’æ·±åœ³<br/>æ¯”äºšè¿ªç§¦/æ±‰â†’è¥¿å®‰</p>
                    </div>
                </div>

                <h3>ğŸ“Š æ€§èƒ½æŒ‡æ ‡ä¼˜ç§€</h3>
                <div class="highlight">
                    <ul>
                        <li><span class="status-badge status-success"><strong>æ•°æ®å‘é€æˆåŠŸç‡ï¼š99.5%</strong></span></li>
                        <li><span class="status-badge status-success"><strong>æ•…éšœçŠ¶æ€åŠ¨æ€å˜åŒ–</strong></span>ï¼šå®šæœŸä»æ•…éšœæ¢å¤åˆ°æ­£å¸¸</li>
                        <li><span class="status-badge status-success"><strong>å¤šè½¦è¾†å¹¶è¡Œ</strong></span>ï¼š3è¾†è½¦åŒæ—¶ç¨³å®šè¿è¡Œ</li>
                        <li><span class="status-badge status-success"><strong>å®æ—¶å“åº”</strong></span>ï¼šå‰ç«¯å³æ—¶æ˜¾ç¤ºæœ€æ–°æ•°æ®</li>
                    </ul>
                </div>

                <div class="highlight" style="text-align: center; font-size: 1.2em; margin-top: 30px;">
                    <strong>ğŸ¯ æ€»ç»“ï¼šä»"ä¸€çœ‹å°±æ˜¯æ¨¡æ‹Ÿæ•°æ®"åˆ°"å®Œå…¨çœŸå®çš„è½¦è”ç½‘è¯Šæ–­ç³»ç»Ÿ"ï¼Œé—®é¢˜å…¨é¢è§£å†³ï¼</strong>
                </div>
            </div>
        </div>

        <div style="text-align: center; padding: 40px 0; color: var(--text-secondary);">
            <p>Â© 2025 è½¦è”ç½‘Redis Streamåˆ†å¸ƒå¼è¯Šæ–­ç³»ç»Ÿæ¶æ„åˆ†æ</p>
            <p>Generated at: <span id="current-time"></span></p>
        </div>
    </div>

    <script>
        // åˆå§‹åŒ–Mermaid
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true
            }
        });

        // æ˜¾ç¤ºå½“å‰æ—¶é—´
        document.getElementById('current-time').textContent = new Date().toLocaleString('zh-CN');

        // å¹³æ»‘æ»šåŠ¨
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // ä»£ç é«˜äº®
        Prism.highlightAll();
    </script>
</body>
</html> 